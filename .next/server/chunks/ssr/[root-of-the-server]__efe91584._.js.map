{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase-admin.ts"],"sourcesContent":["import { initializeApp, getApps, cert } from 'firebase-admin/app';\nimport { getFirestore } from 'firebase-admin/firestore';\n\nconst apps = getApps();\n\nif (!apps.length) {\n  try {\n    const projectId = process.env.FIREBASE_PROJECT_ID;\n    const clientEmail = process.env.FIREBASE_CLIENT_EMAIL;\n    const privateKey = process.env.FIREBASE_PRIVATE_KEY;\n\n    if (!projectId || !clientEmail || !privateKey) {\n      throw new Error('Missing Firebase Admin credentials in environment variables.');\n    }\n\n    // Reemplazar los literales \\n con saltos de línea reales\n    const formattedPrivateKey = privateKey.replace(/\\\\n/g, '\\n');\n\n    initializeApp({\n      credential: cert({\n        projectId,\n        clientEmail,\n        privateKey: formattedPrivateKey,\n      }),\n    });\n\n    console.log('✅ Firebase Admin initialized successfully');\n  } catch (error) {\n    console.error('❌ Error initializing Firebase Admin:', error);\n    // Don't throw in production, just log\n    if (process.env.NODE_ENV !== 'production') {\n        throw error;\n    }\n  }\n}\n\nexport const adminDb = getFirestore();\n"],"names":[],"mappings":";;;AAAA;AACA;;;;;;;;AAEA,MAAM,OAAO,CAAA,GAAA,gJAAA,CAAA,UAAO,AAAD;AAEnB,IAAI,CAAC,KAAK,MAAM,EAAE;IAChB,IAAI;QACF,MAAM,YAAY,QAAQ,GAAG,CAAC,mBAAmB;QACjD,MAAM,cAAc,QAAQ,GAAG,CAAC,qBAAqB;QACrD,MAAM,aAAa,QAAQ,GAAG,CAAC,oBAAoB;QAEnD,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,YAAY;YAC7C,MAAM,IAAI,MAAM;QAClB;QAEA,yDAAyD;QACzD,MAAM,sBAAsB,WAAW,OAAO,CAAC,QAAQ;QAEvD,CAAA,GAAA,gJAAA,CAAA,gBAAa,AAAD,EAAE;YACZ,YAAY,CAAA,GAAA,gJAAA,CAAA,OAAI,AAAD,EAAE;gBACf;gBACA;gBACA,YAAY;YACd;QACF;QAEA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wCAAwC;QACtD,sCAAsC;QACtC,IAAI,oDAAyB,cAAc;YACvC,MAAM;QACV;IACF;AACF;AAEO,MAAM,UAAU,CAAA,GAAA,4JAAA,CAAA,eAAY,AAAD","debugId":null}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/settings/actions.ts"],"sourcesContent":["'use server';\n\nimport { adminDb } from '@/lib/firebase-admin';\nimport { getAuth } from 'firebase-admin/auth';\nimport { revalidatePath } from 'next/cache';\nimport * as z from 'zod';\nimport { auth } from '@/lib/firebase';\nimport { reauthenticateWithCredential, EmailAuthProvider, updatePassword as clientUpdatePassword } from 'firebase/auth';\n\n\nconst profileFormSchema = z.object({\n  uid: z.string(),\n  displayName: z.string().min(3, { message: 'El nombre es requerido.' }),\n  telefono: z.string().optional(),\n  area: z.string().optional(),\n  empresa: z.string().optional(),\n  ciudad: z.string().optional(),\n  planta: z.string().optional(),\n});\n\nconst passwordFormSchema = z.object({\n  currentPassword: z.string().min(6, 'La contraseña actual es requerida.'),\n  newPassword: z.string().min(6, 'La nueva contraseña debe tener al menos 6 caracteres.'),\n});\n\n\nexport async function updateUserProfile(data: z.infer<typeof profileFormSchema>) {\n  try {\n    const { uid, ...profileData } = data;\n\n    // Actualizar documento en Firestore\n    await adminDb.collection('users').doc(uid).update(profileData);\n    \n    // Actualizar display name en Firebase Auth (si cambió)\n    const auth = getAuth();\n    const userRecord = await auth.getUser(uid);\n    if (userRecord.displayName !== profileData.displayName) {\n        await auth.updateUser(uid, { displayName: profileData.displayName });\n    }\n\n    revalidatePath('/settings');\n    revalidatePath('/(app)/layout'); // Para refrescar el sidebar/header\n    \n    return { success: true };\n  } catch (error: any) {\n    console.error('Error updating user profile:', error);\n    return { error: 'No se pudo actualizar el perfil.' };\n  }\n}\n\nexport async function changePassword(uid: string, data: z.infer<typeof passwordFormSchema>) {\n    if (!uid) {\n        return { error: 'Usuario no autenticado.' };\n    }\n    \n    try {\n        const auth = getAuth();\n        // El cambio de contraseña desde el Admin SDK no requiere la contraseña actual.\n        // La validación de la contraseña actual debe hacerse en el cliente antes de llamar a esta acción.\n        // Sin embargo, por seguridad, es mejor usar el SDK del cliente para esto.\n        // Esta acción del servidor es un placeholder si se quisiera forzar desde admin.\n        // La lógica real se manejará en el cliente con reautenticación.\n        await auth.updateUser(uid, {\n            password: data.newPassword\n        });\n\n        return { success: true };\n    } catch(error: any) {\n        console.error('Error changing password with Admin SDK:', error);\n        if(error.code === 'auth/weak-password') {\n            return { error: 'La nueva contraseña es demasiado débil.'};\n        }\n        return { error: 'No se pudo cambiar la contraseña.' };\n    }\n}\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;AAKA,MAAM,oBAAoB,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,EAAE;IACjC,KAAK,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD;IACZ,aAAa,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,GAAG,CAAC,GAAG;QAAE,SAAS;IAA0B;IACpE,UAAU,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,QAAQ;IAC7B,MAAM,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,QAAQ;IACzB,SAAS,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,QAAQ;IAC5B,QAAQ,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,QAAQ;IAC3B,QAAQ,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,QAAQ;AAC7B;AAEA,MAAM,qBAAqB,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,EAAE;IAClC,iBAAiB,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,GAAG,CAAC,GAAG;IACnC,aAAa,CAAA,GAAA,oIAAA,CAAA,SAAQ,AAAD,IAAI,GAAG,CAAC,GAAG;AACjC;AAGO,eAAe,kBAAkB,IAAuC;IAC7E,IAAI;QACF,MAAM,EAAE,GAAG,EAAE,GAAG,aAAa,GAAG;QAEhC,oCAAoC;QACpC,MAAM,+HAAA,CAAA,UAAO,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,KAAK,MAAM,CAAC;QAElD,uDAAuD;QACvD,MAAM,OAAO,CAAA,GAAA,kJAAA,CAAA,UAAO,AAAD;QACnB,MAAM,aAAa,MAAM,KAAK,OAAO,CAAC;QACtC,IAAI,WAAW,WAAW,KAAK,YAAY,WAAW,EAAE;YACpD,MAAM,KAAK,UAAU,CAAC,KAAK;gBAAE,aAAa,YAAY,WAAW;YAAC;QACtE;QAEA,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;QACf,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE,kBAAkB,mCAAmC;QAEpE,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;YAAE,OAAO;QAAmC;IACrD;AACF;AAEO,eAAe,eAAe,GAAW,EAAE,IAAwC;IACtF,IAAI,CAAC,KAAK;QACN,OAAO;YAAE,OAAO;QAA0B;IAC9C;IAEA,IAAI;QACA,MAAM,OAAO,CAAA,GAAA,kJAAA,CAAA,UAAO,AAAD;QACnB,+EAA+E;QAC/E,kGAAkG;QAClG,0EAA0E;QAC1E,gFAAgF;QAChF,gEAAgE;QAChE,MAAM,KAAK,UAAU,CAAC,KAAK;YACvB,UAAU,KAAK,WAAW;QAC9B;QAEA,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAM,OAAY;QAChB,QAAQ,KAAK,CAAC,2CAA2C;QACzD,IAAG,MAAM,IAAI,KAAK,sBAAsB;YACpC,OAAO;gBAAE,OAAO;YAAyC;QAC7D;QACA,OAAO;YAAE,OAAO;QAAoC;IACxD;AACJ;;;IAhDsB;IAwBA;;AAxBA,+OAAA;AAwBA,+OAAA","debugId":null}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/%28app%29/settings/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {updateUserProfile as '4049e49afa3242931a11b0b08c669454bcc3650692'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 272, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/settings/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(app)/settings/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(app)/settings/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","debugId":null}},
    {"offset": {"line": 286, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/settings/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(app)/settings/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(app)/settings/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA+Q,GAC5S,6CACA","debugId":null}},
    {"offset": {"line": 300, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}