{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase-admin.ts"],"sourcesContent":["import { initializeApp, getApps, cert } from 'firebase-admin/app';\nimport { getFirestore } from 'firebase-admin/firestore';\n\nconst apps = getApps();\n\nif (!apps.length) {\n  try {\n    const projectId = process.env.FIREBASE_PROJECT_ID;\n    const clientEmail = process.env.FIREBASE_CLIENT_EMAIL;\n    const privateKey = process.env.FIREBASE_PRIVATE_KEY;\n\n    if (!projectId || !clientEmail || !privateKey) {\n      throw new Error('Missing Firebase Admin credentials in environment variables.');\n    }\n\n    // Reemplazar los literales \\n con saltos de línea reales\n    const formattedPrivateKey = privateKey.replace(/\\\\n/g, '\\n');\n\n    initializeApp({\n      credential: cert({\n        projectId,\n        clientEmail,\n        privateKey: formattedPrivateKey,\n      }),\n    });\n\n    console.log('✅ Firebase Admin initialized successfully');\n  } catch (error) {\n    console.error('❌ Error initializing Firebase Admin:', error);\n    // Don't throw in production, just log\n    if (process.env.NODE_ENV !== 'production') {\n        throw error;\n    }\n  }\n}\n\nexport const adminDb = getFirestore();\n"],"names":[],"mappings":";;;AAAA;AACA;;;;;;;;AAEA,MAAM,OAAO,CAAA,GAAA,gJAAA,CAAA,UAAO,AAAD;AAEnB,IAAI,CAAC,KAAK,MAAM,EAAE;IAChB,IAAI;QACF,MAAM,YAAY,QAAQ,GAAG,CAAC,mBAAmB;QACjD,MAAM,cAAc,QAAQ,GAAG,CAAC,qBAAqB;QACrD,MAAM,aAAa,QAAQ,GAAG,CAAC,oBAAoB;QAEnD,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,YAAY;YAC7C,MAAM,IAAI,MAAM;QAClB;QAEA,yDAAyD;QACzD,MAAM,sBAAsB,WAAW,OAAO,CAAC,QAAQ;QAEvD,CAAA,GAAA,gJAAA,CAAA,gBAAa,AAAD,EAAE;YACZ,YAAY,CAAA,GAAA,gJAAA,CAAA,OAAI,AAAD,EAAE;gBACf;gBACA;gBACA,YAAY;YACd;QACF;QAEA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wCAAwC;QACtD,sCAAsC;QACtC,IAAI,oDAAyB,cAAc;YACvC,MAAM;QACV;IACF;AACF;AAEO,MAAM,UAAU,CAAA,GAAA,4JAAA,CAAA,eAAY,AAAD","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/notifications.ts"],"sourcesContent":["\n'use server';\n\nimport twilio from 'twilio';\n\n// Load credentials directly from environment variables\nconst accountSid = process.env.TWILIO_ACCOUNT_SID;\nconst authToken = process.env.TWILIO_AUTH_TOKEN;\nconst twilioWhatsAppFrom = process.env.TWILIO_WHATSAPP_FROM;\nconst whatsAppTo = process.env.WHATSAPP_TO;\n\nexport async function sendWhatsAppNotification(messageBody: string) {\n  if (!accountSid || !authToken || !twilioWhatsAppFrom || !whatsAppTo) {\n    console.error('⚠️ [Twilio] Error: Credenciales no configuradas. Las variables de entorno (TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, TWILIO_WHATSAPP_FROM, WHATSAPP_TO) deben estar definidas.');\n    // No lanzar error para no detener el flujo principal, solo registrar.\n    return { success: false, error: 'Servicio de notificaciones no configurado en el servidor.' };\n  }\n\n  const client = twilio(accountSid, authToken);\n\n  try {\n    console.log(`[Twilio] Intentando enviar notificación a ${whatsAppTo}...`);\n    const message = await client.messages.create({\n      body: messageBody,\n      from: twilioWhatsAppFrom,\n      to: whatsAppTo,\n    });\n    console.log(`✅ [Twilio] Notificación enviada con éxito. SID: ${message.sid}`);\n    return { success: true, sid: message.sid };\n  } catch (error) {\n    console.error('❌ [Twilio] Falló el envío de la notificación por WhatsApp:', error);\n    // No relanzar el error para no afectar la experiencia de usuario.\n    // El error ya está registrado en el servidor para depuración.\n    return { success: false, error: 'No se pudo enviar la notificación por WhatsApp.' };\n  }\n}\n"],"names":[],"mappings":";;;;;AAGA;;;;;AAEA,uDAAuD;AACvD,MAAM,aAAa,QAAQ,GAAG,CAAC,kBAAkB;AACjD,MAAM,YAAY,QAAQ,GAAG,CAAC,iBAAiB;AAC/C,MAAM,qBAAqB,QAAQ,GAAG,CAAC,oBAAoB;AAC3D,MAAM,aAAa,QAAQ,GAAG,CAAC,WAAW;AAEnC,eAAe,yBAAyB,WAAmB;IAChE,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,sBAAsB,CAAC,YAAY;QACnE,QAAQ,KAAK,CAAC;QACd,sEAAsE;QACtE,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4D;IAC9F;IAEA,MAAM,SAAS,CAAA,GAAA,sIAAA,CAAA,UAAM,AAAD,EAAE,YAAY;IAElC,IAAI;QACF,QAAQ,GAAG,CAAC,CAAC,0CAA0C,EAAE,WAAW,GAAG,CAAC;QACxE,MAAM,UAAU,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;YAC3C,MAAM;YACN,MAAM;YACN,IAAI;QACN;QACA,QAAQ,GAAG,CAAC,CAAC,gDAAgD,EAAE,QAAQ,GAAG,EAAE;QAC5E,OAAO;YAAE,SAAS;YAAM,KAAK,QAAQ,GAAG;QAAC;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8DAA8D;QAC5E,kEAAkE;QAClE,8DAA8D;QAC9D,OAAO;YAAE,SAAS;YAAO,OAAO;QAAkD;IACpF;AACF;;;IAxBsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 401, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/genkit.ts"],"sourcesContent":["import {genkit} from 'genkit';\nimport {googleAI} from '@genkit-ai/google-genai';\n\nexport const ai = genkit({\n  plugins: [googleAI()],\n  model: 'googleai/gemini-2.5-flash',\n});\n"],"names":[],"mappings":";;;AAAA;AAAA;AACA;AAAA;;;AAEO,MAAM,KAAK,CAAA,GAAA,uIAAA,CAAA,SAAM,AAAD,EAAE;IACvB,SAAS;QAAC,CAAA,GAAA,6KAAA,CAAA,WAAQ,AAAD;KAAI;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/risk-assessment-recommendation.ts"],"sourcesContent":["'use server';\n\n/**\n * @fileOverview Un agente de IA de evaluación de riesgos que recomienda controles de riesgo.\n *\n * - getRiskAssessmentRecommendations - Una función que gestiona el proceso de evaluación de riesgos.\n * - RiskAssessmentInput - El tipo de entrada para la función getRiskAssessmentRecommendations.\n * - RiskAssessmentOutput - El tipo de retorno para la función getRiskAssessmentRecommendations.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst RiskAssessmentInputSchema = z.object({\n  workType: z.string().describe('El tipo de trabajo que se está realizando.'),\n  environmentalFactors: z.string().describe('Factores ambientales presentes en el lugar de trabajo.'),\n  permitDetails: z.string().describe('Información detallada sobre la solicitud de permiso de trabajo.'),\n});\nexport type RiskAssessmentInput = z.infer<typeof RiskAssessmentInputSchema>;\n\nconst RiskAssessmentOutputSchema = z.object({\n  recommendedControls: z.string().describe('Los controles de riesgo recomendados para la solicitud de permiso de trabajo.'),\n});\nexport type RiskAssessmentOutput = z.infer<typeof RiskAssessmentOutputSchema>;\n\nexport async function getRiskAssessmentRecommendations(input: RiskAssessmentInput): Promise<RiskAssessmentOutput> {\n  return riskAssessmentFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'riskAssessmentPrompt',\n  input: {schema: RiskAssessmentInputSchema},\n  output: {schema: RiskAssessmentOutputSchema},\n  prompt: `Eres un oficial de seguridad responsable de evaluar riesgos y recomendar controles para permisos de trabajo.\n\n  Basándote en los detalles de la solicitud del permiso de trabajo, el tipo de trabajo que se realiza y los factores ambientales presentes, recomendarás los controles de riesgo apropiados.\n\n  Tipo de Trabajo: {{{workType}}}\n  Factores Ambientales: {{{environmentalFactors}}}\n  Detalles del Permiso: {{{permitDetails}}}\n\n  Controles de Riesgo Recomendados:`,\n});\n\nconst riskAssessmentFlow = ai.defineFlow(\n  {\n    name: 'riskAssessmentFlow',\n    inputSchema: RiskAssessmentInputSchema,\n    outputSchema: RiskAssessmentOutputSchema,\n  },\n  async input => {\n    const {output} = await prompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;AAEA;;;;;;CAMC,GAED;AACA;AAAA;;;;;;AAEA,MAAM,4BAA4B,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACzC,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC9B,sBAAsB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC1C,eAAe,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AACrC;AAGA,MAAM,6BAA6B,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC1C,qBAAqB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC3C;AAGO,eAAe,iCAAiC,KAA0B;IAC/E,OAAO,mBAAmB;AAC5B;AAEA,MAAM,SAAS,mHAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IAC7B,MAAM;IACN,OAAO;QAAC,QAAQ;IAAyB;IACzC,QAAQ;QAAC,QAAQ;IAA0B;IAC3C,QAAQ,CAAC;;;;;;;;mCAQwB,CAAC;AACpC;AAEA,MAAM,qBAAqB,mHAAA,CAAA,KAAE,CAAC,UAAU,CACtC;IACE,MAAM;IACN,aAAa;IACb,cAAc;AAChB,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,OAAO;IAC9B,OAAO;AACT;;;IA5BoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 489, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/%28app%29/permits/create/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {createPermit as '401402f01c0118016efe5c5d736d335e2f6d150079'} from 'ACTIONS_MODULE0'\nexport {getRiskAssessmentRecommendations as '401d2929af3bb2809a59f1fa2b833eaa16ed136c97'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AACA","debugId":null}},
    {"offset": {"line": 576, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(app)/permits/create/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(app)/permits/create/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAyS,GACtU,uEACA","debugId":null}},
    {"offset": {"line": 590, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(app)/permits/create/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(app)/permits/create/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAqR,GAClT,mDACA","debugId":null}}]
}