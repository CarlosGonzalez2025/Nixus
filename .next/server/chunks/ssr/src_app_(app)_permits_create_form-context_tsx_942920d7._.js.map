{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/form-context.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useReducer, useContext, Dispatch } from 'react';\nimport type { Permit, ExternalWorker, AnexoATS, AnexoAltura, AnexoConfinado, AnexoEnergias, AnexoIzaje, AnexoExcavaciones, VerificacionPeligros, EppEmergencias } from '@/types';\n\n// Define the shape of the form data\ntype PermitFormData = Omit<Permit, 'id' | 'createdAt' | 'status' | 'createdBy' | 'number' | 'user' | 'approvals' | 'closure'>;\n\n// Define the shape of the state\ninterface FormState extends PermitFormData {}\n\n// Define the actions\ntype FormAction =\n  | { type: 'UPDATE_GENERAL_INFO'; payload: Partial<FormState['generalInfo']> }\n  | { type: 'UPDATE_WORK_TYPES'; payload: { type: keyof FormState['selectedWorkTypes'], value: boolean } }\n  | { type: 'UPDATE_ATS'; payload: Partial<FormState['anexoATS']> }\n  | { type: 'UPDATE_ANEXO_ALTURA'; payload: Partial<FormState['anexoAltura']> }\n  | { type: 'UPDATE_ANEXO_CONFINADO'; payload: Partial<FormState['anexoConfinado']> }\n  | { type: 'UPDATE_ANEXO_ENERGIA'; payload: Partial<FormState['anexoEnergias']> }\n  | { type: 'UPDATE_ANEXO_IZAJE'; payload: Partial<FormState['anexoIzaje']> }\n  | { type: 'UPDATE_ANEXO_EXCAVACIONES'; payload: Partial<FormState['anexoExcavaciones']> }\n  | { type: 'UPDATE_VERIFICACION_PELIGROS'; payload: Partial<FormState['verificacionPeligros']> }\n  | { type: 'UPDATE_EPP_EMERGENCIAS'; payload: Partial<FormState['eppEmergencias']> }\n  | { type: 'SET_WORKERS'; payload: ExternalWorker[] }\n  | { type: 'ADD_WORKER'; payload: ExternalWorker }\n  | { type: 'UPDATE_SIGNATURE', payload: { target: string, signature: string, context: any } }\n  | { type: 'RESET_FORM' };\n\n\n// Initial state\nconst initialState: FormState = {\n  generalInfo: {\n    areaEspecifica: '',\n    planta: '',\n    proceso: '',\n    contrato: '',\n    empresa: '',\n    nombreSolicitante: '',\n    fechaCreacion: new Date().toISOString(),\n    validFrom: '',\n    validUntil: '',\n    workDescription: '',\n    tools: [],\n    numTrabajadores: '',\n    reunionInicio: 'na',\n    atsVerificado: 'na',\n    responsable: { nombre: '', cargo: '', compania: '', alcance: '' }\n  },\n  selectedWorkTypes: {\n    alturas: false,\n    confinado: false,\n    energia: false,\n    izaje: false,\n    caliente: false,\n    excavacion: false,\n    general: false,\n  },\n  anexoATS: {\n    peligros: {},\n    controles: {},\n    epp: {},\n    justificacion: {},\n  },\n  anexoAltura: {\n    tipoEstructura: {\n        escaleraCuerpo: false,\n        escaleraDosCuerpos: false,\n        andamioTubular: false,\n        andamioColgante: false,\n        plataforma: false,\n        manLift: false,\n        otros: false,\n        otrosCual: '',\n    },\n    aspectosSeguridad: {},\n    precauciones: {},\n    afectaciones: {\n        riesgoOtrasAreas: 'na',\n        otrasAreasRiesgo: 'na',\n        personalNotificado: 'na',\n        observaciones: '',\n    },\n  },\n  anexoConfinado: {\n    identificacionPeligros: {},\n    precauciones: {},\n    resultadosPruebasGases: {},\n    requerimientosEquipos: {},\n    pruebasGasesPeriodicas: {\n      intervalo: '',\n      pruebas: [],\n      pruebaRealizadaPor: '',\n      serialMonitor: '',\n      marca: '',\n      fechaCalibracion: '',\n    },\n    validacion: {\n        autoridad: [],\n        responsable: [],\n    },\n  },\n  anexoEnergias: {\n    trabajosEnCaliente: {},\n    energiasPeligrosas: {},\n    procedimientoLOTO: {},\n    trabajosConEnergiaElectrica: {},\n    tensionExpuesta: {},\n    planeacion: {},\n    metodoTrabajo: {\n      sinTension: false,\n      conTension: false,\n    },\n    trabajoConTension: {},\n    trabajoSinTension: {},\n    observaciones: '',\n  },\n  anexoIzaje: {\n    informacionGeneral: {\n        accion: {},\n        pesoCarga: {},\n        equipoUtilizar: {},\n        capacidadEquipo: '',\n    },\n    aspectosRequeridos: {},\n    precauciones: {},\n  },\n  anexoExcavaciones: {\n    informacionGeneral: {\n      dimensiones: '',\n      profundidad: '',\n      ancho: '',\n      largo: '',\n    },\n    aspectosRequeridos: {},\n    precauciones: {},\n  },\n  verificacionPeligros: {\n    fisicos: {},\n    quimicos: {},\n    seguridad: {},\n    locativos: {},\n    biologicoAmbiental: {},\n    biomecanicos: {},\n    psicosocial: {},\n  },\n  eppEmergencias: {\n    epp: {},\n    emergencias: {},\n  },\n  workers: [],\n};\n\n// Reducer function\nfunction formReducer(state: FormState, action: FormAction): FormState {\n  switch (action.type) {\n    case 'UPDATE_GENERAL_INFO':\n      return {\n        ...state,\n        generalInfo: { ...state.generalInfo, ...action.payload },\n      };\n    case 'UPDATE_WORK_TYPES':\n        return {\n            ...state,\n            selectedWorkTypes: { ...state.selectedWorkTypes, [action.payload.type]: action.payload.value }\n        }\n    case 'UPDATE_ATS':\n        return {\n            ...state,\n            anexoATS: { ...state.anexoATS, ...action.payload },\n        }\n    case 'UPDATE_ANEXO_ALTURA':\n        return {\n            ...state,\n            anexoAltura: { ...state.anexoAltura, ...action.payload },\n        }\n    case 'UPDATE_ANEXO_CONFINADO':\n        return {\n            ...state,\n            anexoConfinado: { ...state.anexoConfinado, ...action.payload },\n        }\n    case 'UPDATE_ANEXO_ENERGIA':\n        return {\n            ...state,\n            anexoEnergias: { ...state.anexoEnergias, ...action.payload },\n        }\n    case 'UPDATE_ANEXO_IZAJE':\n        return {\n            ...state,\n            anexoIzaje: { ...state.anexoIzaje, ...action.payload },\n        }\n    case 'UPDATE_ANEXO_EXCAVACIONES':\n        return {\n            ...state,\n            anexoExcavaciones: { ...state.anexoExcavaciones, ...action.payload },\n        }\n    case 'UPDATE_VERIFICACION_PELIGROS':\n        return {\n            ...state,\n            verificacionPeligros: { ...state.verificacionPeligros, ...action.payload },\n        }\n    case 'UPDATE_EPP_EMERGENCIAS':\n        return {\n            ...state,\n            eppEmergencias: { ...state.eppEmergencias, ...action.payload },\n        }\n    case 'SET_WORKERS':\n        return {\n            ...state,\n            workers: action.payload,\n        }\n    case 'ADD_WORKER':\n        return {\n            ...state,\n            workers: [...(state.workers || []), action.payload]\n        }\n    case 'UPDATE_SIGNATURE':\n      // Complex logic for updating signatures in nested annexes can be handled here\n      // This is a simplified example\n      console.log('Signature update needs to be implemented in reducer:', action.payload);\n      return state;\n    case 'RESET_FORM':\n      return initialState;\n    default:\n      return state;\n  }\n}\n\n// Create the context\nconst PermitFormContext = createContext<{ state: FormState; dispatch: Dispatch<FormAction> } | undefined>(undefined);\n\n// Create the provider component\nexport function PermitFormProvider({ children }: { children: React.ReactNode }) {\n  const [state, dispatch] = useReducer(formReducer, initialState);\n\n  return (\n    <PermitFormContext.Provider value={{ state, dispatch }}>\n      {children}\n    </PermitFormContext.Provider>\n  );\n}\n\n// Custom hook to use the context\nexport function usePermitForm() {\n  const context = useContext(PermitFormContext);\n  if (!context) {\n    throw new Error('usePermitForm must be used within a PermitFormProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}