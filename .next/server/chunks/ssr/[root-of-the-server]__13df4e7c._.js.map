{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, getApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { getFirestore } from 'firebase/firestore';\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\n\nconst app = !getApps().length ? initializeApp(firebaseConfig) : getApp();\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\nexport { app, auth, db, firebaseConfig };\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAGA,MAAM,MAAM,CAAC,CAAA,GAAA,oLAAA,CAAA,UAAO,AAAD,IAAI,MAAM,GAAG,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE,kBAAkB,CAAA,GAAA,oLAAA,CAAA,SAAM,AAAD;AACrE,MAAM,OAAO,CAAA,GAAA,yOAAA,CAAA,UAAO,AAAD,EAAE;AACrB,MAAM,KAAK,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/error-emitter.ts"],"sourcesContent":["\nimport { EventEmitter } from 'events';\nimport type { FirestorePermissionError } from './errors';\n\n// This is a workaround for the fact that EventEmitter is not typed\ninterface TypedEventEmitter {\n  on(event: 'permission-error', listener: (error: FirestorePermissionError) => void): this;\n  emit(event: 'permission-error', error: FirestorePermissionError): boolean;\n}\n\nclass SafeEventEmitter extends EventEmitter implements TypedEventEmitter {}\n\n// Create a singleton instance of the event emitter\nexport const errorEmitter = new SafeEventEmitter();\n"],"names":[],"mappings":";;;AACA;;AASA,MAAM,yBAAyB,qGAAA,CAAA,eAAY;AAA+B;AAGnE,MAAM,eAAe,IAAI","debugId":null}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/errors.ts"],"sourcesContent":["\nexport type SecurityRuleContext = {\n  path: string;\n  operation: 'get' | 'list' | 'create' | 'update' | 'delete' | 'write';\n  requestResourceData?: any;\n};\n\nexport class FirestorePermissionError extends Error {\n  context: SecurityRuleContext;\n\n  constructor(context: SecurityRuleContext) {\n    const message = `FirestoreError: Missing or insufficient permissions. The following request was denied by Firestore Security Rules:\\n${JSON.stringify(\n      {\n        context,\n      },\n      null,\n      2\n    )}`;\n    super(message);\n    this.name = 'FirestorePermissionError';\n    this.context = context;\n\n    // This is to make the error message more readable in the console\n    Object.setPrototypeOf(this, FirestorePermissionError.prototype);\n  }\n}\n"],"names":[],"mappings":";;;AAOO,MAAM,iCAAiC;IAC5C,QAA6B;IAE7B,YAAY,OAA4B,CAAE;QACxC,MAAM,UAAU,CAAC,oHAAoH,EAAE,KAAK,SAAS,CACnJ;YACE;QACF,GACA,MACA,IACC;QACH,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,OAAO,GAAG;QAEf,iEAAiE;QACjE,OAAO,cAAc,CAAC,IAAI,EAAE,yBAAyB,SAAS;IAChE;AACF","debugId":null}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/actions.ts"],"sourcesContent":["\n'use server';\n\nimport { db } from '@/lib/firebase';\nimport { collection, addDoc, serverTimestamp } from 'firebase/firestore';\nimport { revalidatePath } from 'next/cache';\nimport { errorEmitter } from '@/lib/error-emitter';\nimport { FirestorePermissionError } from '@/lib/errors';\nimport type { SecurityRuleContext } from '@/lib/errors';\nimport type { Permit } from '@/types';\n\ntype PermitCreateData = Omit<Permit, 'id' | 'createdAt' | 'status' | 'createdBy' | 'number' | 'user' > & {\n  userId: string;\n  userDisplayName: string | null;\n};\n\n\nexport async function createPermit(data: PermitCreateData) {\n  if (!data.userId) {\n    return { error: 'User not authenticated' };\n  }\n\n  const { userId, userDisplayName, ...permitData } = data;\n\n  // Initialize all approval roles as pending\n  const initialApprovals = {\n    solicitante: { status: 'pendiente', userId: userId, userName: userDisplayName },\n    autorizante: { status: 'pendiente' },\n    mantenimiento: { status: 'pendiente' },\n    sst: { status: 'pendiente' }\n  };\n\n  const permitPayload: Omit<Permit, 'id'> = {\n    ...permitData,\n    status: 'pendiente_revision',\n    createdBy: userId,\n    createdAt: serverTimestamp(),\n    approvals: initialApprovals,\n  };\n  \n  const permitsCollectionRef = collection(db, 'permits');\n\n  try {\n    const docRef = await addDoc(permitsCollectionRef, permitPayload);\n    // Revalidate paths to show the new permit in the lists\n    revalidatePath('/permits');\n    revalidatePath('/dashboard');\n    return { success: true, permitId: docRef.id };\n  } catch (serverError: any) {\n    const permissionError = new FirestorePermissionError({\n      path: permitsCollectionRef.path,\n      operation: 'create',\n      requestResourceData: permitPayload,\n    } satisfies SecurityRuleContext);\n    \n    errorEmitter.emit('permission-error', permissionError);\n\n    // Return a structured error for the client\n    return { success: false, error: 'Permission denied. Could not create permit.' };\n  }\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;;AAUO,eAAe,aAAa,IAAsB;IACvD,IAAI,CAAC,KAAK,MAAM,EAAE;QAChB,OAAO;YAAE,OAAO;QAAyB;IAC3C;IAEA,MAAM,EAAE,MAAM,EAAE,eAAe,EAAE,GAAG,YAAY,GAAG;IAEnD,2CAA2C;IAC3C,MAAM,mBAAmB;QACvB,aAAa;YAAE,QAAQ;YAAa,QAAQ;YAAQ,UAAU;QAAgB;QAC9E,aAAa;YAAE,QAAQ;QAAY;QACnC,eAAe;YAAE,QAAQ;QAAY;QACrC,KAAK;YAAE,QAAQ;QAAY;IAC7B;IAEA,MAAM,gBAAoC;QACxC,GAAG,UAAU;QACb,QAAQ;QACR,WAAW;QACX,WAAW,CAAA,GAAA,iKAAA,CAAA,kBAAe,AAAD;QACzB,WAAW;IACb;IAEA,MAAM,uBAAuB,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,sHAAA,CAAA,KAAE,EAAE;IAE5C,IAAI;QACF,MAAM,SAAS,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,sBAAsB;QAClD,uDAAuD;QACvD,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;QACf,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;QACf,OAAO;YAAE,SAAS;YAAM,UAAU,OAAO,EAAE;QAAC;IAC9C,EAAE,OAAO,aAAkB;QACzB,MAAM,kBAAkB,IAAI,oHAAA,CAAA,2BAAwB,CAAC;YACnD,MAAM,qBAAqB,IAAI;YAC/B,WAAW;YACX,qBAAqB;QACvB;QAEA,8HAAA,CAAA,eAAY,CAAC,IAAI,CAAC,oBAAoB;QAEtC,2CAA2C;QAC3C,OAAO;YAAE,SAAS;YAAO,OAAO;QAA8C;IAChF;AACF;;;IA3CsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/genkit.ts"],"sourcesContent":["import {genkit} from 'genkit';\nimport {googleAI} from '@genkit-ai/google-genai';\n\nexport const ai = genkit({\n  plugins: [googleAI()],\n  model: 'googleai/gemini-2.5-flash',\n});\n"],"names":[],"mappings":";;;AAAA;AAAA;AACA;AAAA;;;AAEO,MAAM,KAAK,CAAA,GAAA,uIAAA,CAAA,SAAM,AAAD,EAAE;IACvB,SAAS;QAAC,CAAA,GAAA,6KAAA,CAAA,WAAQ,AAAD;KAAI;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 446, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/risk-assessment-recommendation.ts"],"sourcesContent":["'use server';\n\n/**\n * @fileOverview Un agente de IA de evaluación de riesgos que recomienda controles de riesgo.\n *\n * - getRiskAssessmentRecommendations - Una función que gestiona el proceso de evaluación de riesgos.\n * - RiskAssessmentInput - El tipo de entrada para la función getRiskAssessmentRecommendations.\n * - RiskAssessmentOutput - El tipo de retorno para la función getRiskAssessmentRecommendations.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst RiskAssessmentInputSchema = z.object({\n  workType: z.string().describe('El tipo de trabajo que se está realizando.'),\n  environmentalFactors: z.string().describe('Factores ambientales presentes en el lugar de trabajo.'),\n  permitDetails: z.string().describe('Información detallada sobre la solicitud de permiso de trabajo.'),\n});\nexport type RiskAssessmentInput = z.infer<typeof RiskAssessmentInputSchema>;\n\nconst RiskAssessmentOutputSchema = z.object({\n  recommendedControls: z.string().describe('Los controles de riesgo recomendados para la solicitud de permiso de trabajo.'),\n});\nexport type RiskAssessmentOutput = z.infer<typeof RiskAssessmentOutputSchema>;\n\nexport async function getRiskAssessmentRecommendations(input: RiskAssessmentInput): Promise<RiskAssessmentOutput> {\n  return riskAssessmentFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'riskAssessmentPrompt',\n  input: {schema: RiskAssessmentInputSchema},\n  output: {schema: RiskAssessmentOutputSchema},\n  prompt: `Eres un oficial de seguridad responsable de evaluar riesgos y recomendar controles para permisos de trabajo.\n\n  Basándote en los detalles de la solicitud del permiso de trabajo, el tipo de trabajo que se realiza y los factores ambientales presentes, recomendarás los controles de riesgo apropiados.\n\n  Tipo de Trabajo: {{{workType}}}\n  Factores Ambientales: {{{environmentalFactors}}}\n  Detalles del Permiso: {{{permitDetails}}}\n\n  Controles de Riesgo Recomendados:`,\n});\n\nconst riskAssessmentFlow = ai.defineFlow(\n  {\n    name: 'riskAssessmentFlow',\n    inputSchema: RiskAssessmentInputSchema,\n    outputSchema: RiskAssessmentOutputSchema,\n  },\n  async input => {\n    const {output} = await prompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;AAEA;;;;;;CAMC,GAED;AACA;AAAA;;;;;;AAEA,MAAM,4BAA4B,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACzC,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC9B,sBAAsB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC1C,eAAe,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AACrC;AAGA,MAAM,6BAA6B,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC1C,qBAAqB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC3C;AAGO,eAAe,iCAAiC,KAA0B;IAC/E,OAAO,mBAAmB;AAC5B;AAEA,MAAM,SAAS,mHAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IAC7B,MAAM;IACN,OAAO;QAAC,QAAQ;IAAyB;IACzC,QAAQ;QAAC,QAAQ;IAA0B;IAC3C,QAAQ,CAAC;;;;;;;;mCAQwB,CAAC;AACpC;AAEA,MAAM,qBAAqB,mHAAA,CAAA,KAAE,CAAC,UAAU,CACtC;IACE,MAAM;IACN,aAAa;IACb,cAAc;AAChB,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,OAAO;IAC9B,OAAO;AACT;;;IA5BoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/%28app%29/permits/create/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {createPermit as '4097d45d85355825b31a4c927dbcb1c60fd2c554af'} from 'ACTIONS_MODULE0'\nexport {getRiskAssessmentRecommendations as '401d2929af3bb2809a59f1fa2b833eaa16ed136c97'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AACA","debugId":null}},
    {"offset": {"line": 577, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(app)/permits/create/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(app)/permits/create/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAyS,GACtU,uEACA","debugId":null}},
    {"offset": {"line": 591, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/(app)/permits/create/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/(app)/permits/create/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAqR,GAClT,mDACA","debugId":null}},
    {"offset": {"line": 605, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}