module.exports = {

"[project]/src/app/(app)/permits/data:2f5de7 [app-ssr] (ecmascript) <text/javascript>": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
/* __next_internal_action_entry_do_not_use__ [{"407282eb75929b38cb56be7f0cd547a72b6c80de19":"savePermitDraft"},"src/app/(app)/permits/actions.ts",""] */ __turbopack_context__.s({
    "savePermitDraft": (()=>savePermitDraft)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
"use turbopack no side effects";
;
var savePermitDraft = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("407282eb75929b38cb56be7f0cd547a72b6c80de19", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "savePermitDraft"); //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbid1c2Ugc2VydmVyJztcblxuaW1wb3J0IHsgYWRtaW5EYiwgaXNBZG1pblJlYWR5IH0gZnJvbSAnQC9saWIvZmlyZWJhc2UtYWRtaW4nO1xuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcbmltcG9ydCB0eXBlIHsgUGVybWl0LCBFeHRlcm5hbFdvcmtlciwgUGVybWl0U3RhdHVzLCBQZXJtaXRDbG9zdXJlLCBBcHByb3ZhbCwgVXNlclJvbGUsIEFuZXhvQWx0dXJhLCBBbmV4b0NvbmZpbmFkbywgQW5leG9FbmVyZ2lhcywgQW5leG9FeGNhdmFjaW9uZXMsIEFuZXhvSXphamUsIEFuZXhvQVRTLCBQZXJtaXRHZW5lcmFsSW5mbywgSnVzdGlmaWNhY2lvbkFUUywgVmFsaWRhY2lvbkRpYXJpYSwgVXNlciwgTm90aWZpY2F0aW9uIH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgeyBGaWVsZFZhbHVlLCBVcGRhdGVEYXRhLCBUaW1lc3RhbXAgfSBmcm9tICdmaXJlYmFzZS1hZG1pbi9maXJlc3RvcmUnO1xuaW1wb3J0IHsgc2VuZFdoYXRzQXBwTm90aWZpY2F0aW9uIH0gZnJvbSAnQC9saWIvbm90aWZpY2F0aW9ucyc7XG5pbXBvcnQgeyBnZXRFbWFpbEZvclVzZXIsIHNlbmRQZXJtaXRVcGRhdGVFbWFpbCB9IGZyb20gJ0AvbGliL2VtYWlsJztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJ2RvdGVudic7XG5jb25maWcoKTtcblxuLy8gLS0tIEZ1bmNpb25lcyBBdXhpbGlhcmVzIHBhcmEgTm90aWZpY2FjaW9uZXMgLS0tXG5cbmNvbnN0IGdldEludm9sdmVkVXNlcnMgPSBhc3luYyAocGVybWl0OiBQZXJtaXQpOiBQcm9taXNlPHN0cmluZ1tdPiA9PiB7XG4gIGNvbnN0IHVzZXJJZHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAvLyAxLiBDcmVhZG9yIGRlbCBwZXJtaXNvXG4gIGlmIChwZXJtaXQuY3JlYXRlZEJ5KSB7XG4gICAgdXNlcklkcy5hZGQocGVybWl0LmNyZWF0ZWRCeSk7XG4gIH1cblxuICAvLyAyLiBVc3VhcmlvcyBxdWUgaGFuIGZpcm1hZG9cbiAgT2JqZWN0LnZhbHVlcyhwZXJtaXQuYXBwcm92YWxzIHx8IHt9KS5mb3JFYWNoKGFwcHJvdmFsID0+IHtcbiAgICBpZiAoYXBwcm92YWwgJiYgYXBwcm92YWwudXNlcklkKSB7XG4gICAgICB1c2VySWRzLmFkZChhcHByb3ZhbC51c2VySWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gMy4gUm9sZXMgYWRtaW5pc3RyYXRpdm9zIG8gZGUgc3VwZXJ2aXNpw7NuIHF1ZSBkZWJlcsOtYW4gc2VyIG5vdGlmaWNhZG9zXG4gIGNvbnN0IGFkbWluc1F1ZXJ5ID0gYXdhaXQgYWRtaW5EYi5jb2xsZWN0aW9uKCd1c2VycycpLndoZXJlKCdyb2xlJywgJ2luJywgWydhZG1pbicsICdhdXRvcml6YW50ZScsICdsaWRlcl9zc3QnXSkuZ2V0KCk7XG4gIGFkbWluc1F1ZXJ5LmZvckVhY2goZG9jID0+IHVzZXJJZHMuYWRkKGRvYy5pZCkpO1xuXG4gIHJldHVybiBBcnJheS5mcm9tKHVzZXJJZHMpO1xufTtcblxuY29uc3QgY3JlYXRlTm90aWZpY2F0aW9uID0gYXN5bmMgKFxuICB1c2VySWQ6IHN0cmluZyxcbiAgcGVybWl0OiBQZXJtaXQsXG4gIG1lc3NhZ2U6IHN0cmluZyxcbiAgdHlwZTogTm90aWZpY2F0aW9uWyd0eXBlJ10sXG4gIHRyaWdnZXJlZEJ5OiB7IHVpZDogc3RyaW5nLCBkaXNwbGF5TmFtZTogc3RyaW5nIHwgbnVsbCB9XG4pID0+IHtcbiAgY29uc3Qgbm90aWZpY2F0aW9uOiBPbWl0PE5vdGlmaWNhdGlvbiwgJ2lkJz4gPSB7XG4gICAgdXNlcklkLFxuICAgIHBlcm1pdElkOiBwZXJtaXQuaWQsXG4gICAgcGVybWl0TnVtYmVyOiBwZXJtaXQubnVtYmVyIHx8ICcnLFxuICAgIG1lc3NhZ2UsXG4gICAgdHlwZSxcbiAgICBpc1JlYWQ6IGZhbHNlLFxuICAgIGNyZWF0ZWRBdDogRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKSBhcyBUaW1lc3RhbXAsXG4gICAgdHJpZ2dlcmVkQnksXG4gIH07XG4gIGF3YWl0IGFkbWluRGIuY29sbGVjdGlvbignbm90aWZpY2F0aW9ucycpLmFkZChub3RpZmljYXRpb24gYXMgYW55KTtcbiAgXG4gIC8vIEVudmlhciBjb3JyZW8gZWxlY3Ryw7NuaWNvXG4gIGNvbnN0IHVzZXJFbWFpbCA9IGF3YWl0IGdldEVtYWlsRm9yVXNlcih1c2VySWQpO1xuICBpZiAodXNlckVtYWlsKSB7XG4gICAgYXdhaXQgc2VuZFBlcm1pdFVwZGF0ZUVtYWlsKHtcbiAgICAgIHRvOiB1c2VyRW1haWwsXG4gICAgICBzdWJqZWN0OiBgQWN0dWFsaXphY2nDs24gZW4gUGVybWlzbyBTR1RDOiAke3Blcm1pdC5udW1iZXIgfHwgcGVybWl0LmlkfWAsXG4gICAgICBodG1sOiBgPHA+JHttZXNzYWdlfTwvcD48cD5QdWVkZXMgdmVyIGxvcyBkZXRhbGxlcyBkZWwgcGVybWlzbyBoYWNpZW5kbyBjbGljIDxhIGhyZWY9XCIke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfS9wZXJtaXRzLyR7cGVybWl0LmlkfVwiPmFxdcOtPC9hPi48L3A+YFxuICAgIH0pO1xuICB9XG59O1xuXG4vLyAtLS0gRmluIGRlIEZ1bmNpb25lcyBkZSBOb3RpZmljYWNpb25lcyAtLS1cblxuY29uc3Qgd29ya1R5cGVzTWFwOiB7W2tleTogc3RyaW5nXTogc3RyaW5nfSA9IHtcbiAgJ2FsdHVyYXMnOiAnVHJhYmFqbyBlbiBBbHR1cmFzJyxcbiAgJ2NvbmZpbmFkbyc6ICdFc3BhY2lvcyBDb25maW5hZG9zJyxcbiAgJ2VuZXJnaWEnOiAnQ29udHJvbCBkZSBFbmVyZ8OtYXMnLFxuICAnaXphamUnOiAnSXphamUgZGUgQ2FyZ2FzJyxcbiAgJ2V4Y2F2YWNpb24nOiAnRXhjYXZhY2lvbmVzJyxcbiAgJ2dlbmVyYWwnOiAnVHJhYmFqbyBHZW5lcmFsJ1xufTtcblxuY29uc3QgZ2V0V29ya1R5cGVzU3RyaW5nID0gKHBlcm1pdDogUGFydGlhbDxQZXJtaXQ+KTogc3RyaW5nID0+IHtcbiAgY29uc3Qgc2VsZWN0ZWRUeXBlczogc3RyaW5nW10gPSBbXTtcbiAgaWYgKHBlcm1pdC50cmFiYWpvQWx0dXJhcykgc2VsZWN0ZWRUeXBlcy5wdXNoKCdUcmFiYWpvIGVuIEFsdHVyYXMnKTtcbiAgaWYgKHBlcm1pdC5lc3BhY2lvc0NvbmZpbmFkb3MpIHNlbGVjdGVkVHlwZXMucHVzaCgnRXNwYWNpb3MgQ29uZmluYWRvcycpO1xuICBpZiAocGVybWl0LmNvbnRyb2xFbmVyZ2lhKSBzZWxlY3RlZFR5cGVzLnB1c2goJ0NvbnRyb2wgZGUgRW5lcmfDrWFzJyk7XG4gIGlmIChwZXJtaXQuaXphamVDYXJnYXMpIHNlbGVjdGVkVHlwZXMucHVzaCgnSXphamUgZGUgQ2FyZ2FzJyk7XG4gIGlmIChwZXJtaXQuZXhjYXZhY2lvbmVzKSBzZWxlY3RlZFR5cGVzLnB1c2goJ0V4Y2F2YWNpb25lcycpO1xuICBcbiAgaWYgKHNlbGVjdGVkVHlwZXMubGVuZ3RoID09PSAwKSB7XG4gICAgaWYgKHBlcm1pdC50cmFiYWpvR2VuZXJhbCkgcmV0dXJuICdUcmFiYWpvIEdlbmVyYWwnO1xuICAgIC8vIEZhbGxiYWNrIGZvciBvbGQgZGF0YSBzdHJ1Y3R1cmVcbiAgICBpZiAocGVybWl0LndvcmtUeXBlICYmIEFycmF5LmlzQXJyYXkocGVybWl0LndvcmtUeXBlKSkge1xuICAgICAgcmV0dXJuIHBlcm1pdC53b3JrVHlwZS5tYXAoa2V5ID0+IHdvcmtUeXBlc01hcFtrZXldIHx8IGtleSkuam9pbignLCAnKTtcbiAgICB9XG4gICAgcmV0dXJuICdUcmFiYWpvIEdlbmVyYWwnO1xuICB9XG4gIHJldHVybiBzZWxlY3RlZFR5cGVzLmpvaW4oJywgJyk7XG59O1xuXG5jb25zdCBnZXRTdGF0dXNUZXh0ID0gKHN0YXR1czogc3RyaW5nKSA9PiB7XG4gICAgY29uc3Qgc3RhdHVzVGV4dDoge1trZXk6IHN0cmluZ106IHN0cmluZ30gPSB7XG4gICAgICAnYm9ycmFkb3InOiAnQm9ycmFkb3InLFxuICAgICAgJ3BlbmRpZW50ZV9yZXZpc2lvbic6ICdQZW5kaWVudGUgZGUgUmV2aXNpw7NuJyxcbiAgICAgICdhcHJvYmFkbyc6ICdBcHJvYmFkbycsXG4gICAgICAnZW5fZWplY3VjaW9uJzogJ0VuIEVqZWN1Y2nDs24nLFxuICAgICAgJ3N1c3BlbmRpZG8nOiAnU3VzcGVuZGlkbycsXG4gICAgICAnY2VycmFkbyc6ICdDZXJyYWRvJyxcbiAgICAgICdyZWNoYXphZG8nOiAnUmVjaGF6YWRvJ1xuICAgIH07XG4gICAgcmV0dXJuIHN0YXR1c1RleHRbc3RhdHVzXSB8fCBzdGF0dXM7XG4gIH07XG5cbmNvbnN0IHNpZ25hdHVyZVJvbGVzOiB7IFtrZXkgaW4gJ3NvbGljaXRhbnRlJyB8ICdhdXRvcml6YW50ZScgfCAnbWFudGVuaW1pZW50bycgfCAnbGlkZXJfc3N0JyB8ICdjb29yZGluYWRvcl9hbHR1cmFzJ106IHN0cmluZyB9ID0ge1xuICBjb29yZGluYWRvcl9hbHR1cmFzOiAnQ09PUkRJTkFET1IgREUgVFJBQkFKT1MgRU4gQUxUVVJBUycsXG4gIHNvbGljaXRhbnRlOiAnUVVJRU4gU09MSUNJVEEgKEzDjURFUiBBIENBUkdPIERFTCBFUVVJUE8gRUpFQ1VUQU5URSknLFxuICBhdXRvcml6YW50ZTogJ1FVSUVOIEFVVE9SSVpBIChKRUZFUyBZIERVRcORT1MgREUgQVJFQSknLFxuICBtYW50ZW5pbWllbnRvOiAnUEVSU09OQUwgREUgTUFOVEVOSU1JRU5UTycsXG4gIGxpZGVyX3NzdDogJ0Zpcm1hIFNTVCcsXG59O1xuXG50eXBlIFBlcm1pdENyZWF0ZURhdGEgPSBPbWl0PFBlcm1pdCwgJ2lkJyB8ICdjcmVhdGVkQXQnIHwgJ3N0YXR1cycgfCAnY3JlYXRlZEJ5JyB8ICdudW1iZXInIHwgJ3VzZXInIHwgJ2FwcHJvdmFscycgfCAnY2xvc3VyZSc+ICYge1xuICB1c2VySWQ6IHN0cmluZztcbiAgdXNlckRpc3BsYXlOYW1lOiBzdHJpbmcgfCBudWxsO1xuICB1c2VyRW1haWw6IHN0cmluZyB8IG51bGw7XG4gIHVzZXJQaG90b1VSTDogc3RyaW5nIHwgbnVsbDtcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQZXJtaXQoZGF0YTogUGVybWl0Q3JlYXRlRGF0YSkge1xuICBpZiAoIWRhdGEudXNlcklkKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVXNlciBub3QgYXV0aGVudGljYXRlZCcgfTtcbiAgfVxuICAgaWYgKCFpc0FkbWluUmVhZHkoKSkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NyZWRlbmNpYWxlcyBkZSBhZG1pbmlzdHJhZG9yIGRlIEZpcmViYXNlIG5vIGNvbmZpZ3VyYWRhcyBlbiBlbCBzZXJ2aWRvci4nIH07XG4gIH1cblxuICBjb25zdCB7IHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCB1c2VyRW1haWwsIHVzZXJQaG90b1VSTCwgLi4ucGVybWl0RGF0YSB9ID0gZGF0YTtcblxuICBjb25zdCBpbml0aWFsQXBwcm92YWxzID0ge1xuICAgIHNvbGljaXRhbnRlOiB7IHN0YXR1czogJ3BlbmRpZW50ZScgYXMgY29uc3QgfSxcbiAgICBhdXRvcml6YW50ZTogeyBzdGF0dXM6ICdwZW5kaWVudGUnIGFzIGNvbnN0IH0sXG4gICAgbWFudGVuaW1pZW50bzogeyBzdGF0dXM6ICdwZW5kaWVudGUnIGFzIGNvbnN0IH0sXG4gICAgbGlkZXJfc3N0OiB7IHN0YXR1czogJ3BlbmRpZW50ZScgYXMgY29uc3QgfSxcbiAgICBjb29yZGluYWRvcl9hbHR1cmFzOiB7IHN0YXR1czogJ3BlbmRpZW50ZScgYXMgY29uc3QgfSxcbiAgfTtcblxuICBjb25zdCBwZXJtaXRQYXlsb2FkOiBPbWl0PFBlcm1pdCwgJ2lkJz4gPSB7XG4gICAgLi4ucGVybWl0RGF0YSxcbiAgICBzdGF0dXM6ICdwZW5kaWVudGVfcmV2aXNpb24nIGFzIGNvbnN0LFxuICAgIGNyZWF0ZWRCeTogdXNlcklkLFxuICAgIGNyZWF0ZWRBdDogRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKSBhcyBUaW1lc3RhbXAsXG4gICAgdXNlcjoge1xuICAgICAgZGlzcGxheU5hbWU6IHVzZXJEaXNwbGF5TmFtZSxcbiAgICAgIGVtYWlsOiB1c2VyRW1haWwsXG4gICAgICBwaG90b1VSTDogdXNlclBob3RvVVJMLFxuICAgIH0sXG4gICAgYXBwcm92YWxzOiBpbml0aWFsQXBwcm92YWxzLFxuICAgIHRyYWJham9BbHR1cmFzOiBkYXRhLnRyYWJham9BbHR1cmFzIHx8IGZhbHNlLFxuICAgIGlzU1NUU2lnbmF0dXJlUmVxdWlyZWQ6IGRhdGEuaXNTU1RTaWduYXR1cmVSZXF1aXJlZCB8fCBmYWxzZSxcbiAgICBjbG9zdXJlOiB7fSxcbiAgfTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgZG9jUmVmID0gYXdhaXQgYWRtaW5EYi5jb2xsZWN0aW9uKCdwZXJtaXRzJykuYWRkKHBlcm1pdFBheWxvYWQgYXMgYW55KTtcbiAgICBjb25zdCBwZXJtaXROdW1iZXIgPSBgUFQtJHtEYXRlLm5vdygpfS0ke2RvY1JlZi5pZC5zdWJzdHJpbmcoMCwgNikudG9VcHBlckNhc2UoKX1gO1xuICAgIGF3YWl0IGRvY1JlZi51cGRhdGUoeyBudW1iZXI6IHBlcm1pdE51bWJlciB9KTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygn4pyFIFtBY3Rpb25dIFBlcm1pc28gY3JlYWRvIGNvbiDDqXhpdG8gZW4gRmlyZXN0b3JlOicsIGRvY1JlZi5pZCk7XG5cbiAgICBjb25zdCBjcmVhdGVkUGVybWl0ID0geyAuLi5wZXJtaXRQYXlsb2FkLCBpZDogZG9jUmVmLmlkLCBudW1iZXI6IHBlcm1pdE51bWJlciB9IGFzIFBlcm1pdDtcbiAgICBjb25zdCBpbnZvbHZlZFVzZXJzID0gYXdhaXQgZ2V0SW52b2x2ZWRVc2VycyhjcmVhdGVkUGVybWl0KTtcbiAgICBjb25zdCBtZXNzYWdlID0gYFNlIGNyZcOzIHVuIG51ZXZvIHBlcm1pc28gZGUgdHJhYmFqbzogIyR7cGVybWl0TnVtYmVyfWA7XG4gICAgXG4gICAgZm9yIChjb25zdCB1aWQgb2YgaW52b2x2ZWRVc2Vycykge1xuICAgICAgaWYgKHVpZCAhPT0gdXNlcklkKSB7XG4gICAgICAgIGF3YWl0IGNyZWF0ZU5vdGlmaWNhdGlvbih1aWQsIGNyZWF0ZWRQZXJtaXQsIG1lc3NhZ2UsICdjcmVhdGlvbicsIHsgdWlkOiB1c2VySWQsIGRpc3BsYXlOYW1lOiB1c2VyRGlzcGxheU5hbWUgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgd29ya1R5cGVzVGV4dCA9IGdldFdvcmtUeXBlc1N0cmluZyhwZXJtaXRQYXlsb2FkKTtcbiAgICBjb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkwgfHwgJ2h0dHBzOi8vc2dwdC1tb3ZpbC53ZWIuYXBwJztcbiAgICBjb25zdCBwZXJtaXRVcmwgPSBgJHtiYXNlVXJsfS9wZXJtaXRzLyR7ZG9jUmVmLmlkfWA7XG4gICAgXG4gICAgY29uc3QgbWVzc2FnZUJvZHkgPSBgKsKhQWxlcnRhIGRlIFNlZ3VyaWRhZCBTR1BUISog8J+aqFxuU2UgaGEgY3JlYWRvIHVuYSBudWV2YSBzb2xpY2l0dWQgZGUgcGVybWlzbyBkZSB0cmFiYWpvLlxuXG7wn5OEICpOw7ptZXJvOiogJHtwZXJtaXROdW1iZXJ9XG7wn5GkICpTb2xpY2l0YW50ZToqICR7dXNlckRpc3BsYXlOYW1lIHx8ICdOL0EnfVxu8J+boO+4jyAqVGlwbyBkZSBUcmFiYWpvOiogJHt3b3JrVHlwZXNUZXh0fVxuXG5Qb3IgZmF2b3IsIHJldmlzZSBsYSBzb2xpY2l0dWQgcGFyYSBzdSBhcHJvYmFjacOzbiBlbiBlbCBzaWd1aWVudGUgZW5sYWNlOlxuJHtwZXJtaXRVcmx9YDtcbiAgICBcbiAgICBhd2FpdCBzZW5kV2hhdHNBcHBOb3RpZmljYXRpb24obWVzc2FnZUJvZHkpO1xuICAgIFxuICAgIHJldmFsaWRhdGVQYXRoKCcvcGVybWl0cycpO1xuICAgIHJldmFsaWRhdGVQYXRoKCcvZGFzaGJvYXJkJyk7XG4gICAgXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcGVybWl0SWQ6IGRvY1JlZi5pZCwgcGVybWl0TnVtYmVyIH07XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFtBY3Rpb25dIEVycm9yIGFsIGNyZWFyIHBlcm1pc286XCIsIGVycm9yKTtcbiAgICByZXR1cm4geyBcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdDb3VsZCBub3QgY3JlYXRlIHBlcm1pdC4gUGxlYXNlIHRyeSBhZ2Fpbi4nIFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVQZXJtaXREcmFmdChkYXRhOiBQZXJtaXRDcmVhdGVEYXRhICYgeyBkcmFmdElkPzogc3RyaW5nIH0pIHtcbiAgaWYgKCFkYXRhLnVzZXJJZCkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VzZXIgbm90IGF1dGhlbnRpY2F0ZWQnIH07XG4gIH1cbiAgaWYgKCFpc0FkbWluUmVhZHkoKSkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NyZWRlbmNpYWxlcyBkZSBhZG1pbmlzdHJhZG9yIGRlIEZpcmViYXNlIG5vIGNvbmZpZ3VyYWRhcyBlbiBlbCBzZXJ2aWRvci4nIH07XG4gIH1cblxuICBjb25zdCB7IHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCB1c2VyRW1haWwsIHVzZXJQaG90b1VSTCwgZHJhZnRJZCwgLi4ucGVybWl0RGF0YSB9ID0gZGF0YTtcblxuICBjb25zdCBpbml0aWFsQXBwcm92YWxzID0ge1xuICAgIHNvbGljaXRhbnRlOiB7IHN0YXR1czogJ3BlbmRpZW50ZScgYXMgY29uc3QgfSxcbiAgICBhdXRvcml6YW50ZTogeyBzdGF0dXM6ICdwZW5kaWVudGUnIGFzIGNvbnN0IH0sXG4gICAgbWFudGVuaW1pZW50bzogeyBzdGF0dXM6ICdwZW5kaWVudGUnIGFzIGNvbnN0IH0sXG4gICAgbGlkZXJfc3N0OiB7IHN0YXR1czogJ3BlbmRpZW50ZScgYXMgY29uc3QgfSxcbiAgICBjb29yZGluYWRvcl9hbHR1cmFzOiB7IHN0YXR1czogJ3BlbmRpZW50ZScgYXMgY29uc3QgfSxcbiAgfTtcblxuICBjb25zdCBwZXJtaXRQYXlsb2FkOiBPbWl0PFBlcm1pdCwgJ2lkJyB8ICdjcmVhdGVkQXQnPiA9IHtcbiAgICAuLi5wZXJtaXREYXRhLFxuICAgIHN0YXR1czogJ2JvcnJhZG9yJyBhcyBjb25zdCxcbiAgICBjcmVhdGVkQnk6IHVzZXJJZCxcbiAgICB1c2VyOiB7XG4gICAgICBkaXNwbGF5TmFtZTogdXNlckRpc3BsYXlOYW1lLFxuICAgICAgZW1haWw6IHVzZXJFbWFpbCxcbiAgICAgIHBob3RvVVJMOiB1c2VyUGhvdG9VUkwsXG4gICAgfSxcbiAgICBhcHByb3ZhbHM6IGluaXRpYWxBcHByb3ZhbHMsXG4gICAgdHJhYmFqb0FsdHVyYXM6IGRhdGEudHJhYmFqb0FsdHVyYXMgfHwgZmFsc2UsXG4gICAgaXNTU1RTaWduYXR1cmVSZXF1aXJlZDogZGF0YS5pc1NTVFNpZ25hdHVyZVJlcXVpcmVkIHx8IGZhbHNlLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgaWYgKGRyYWZ0SWQpIHtcbiAgICAgIC8vIEFjdHVhbGl6YXIgdW4gYm9ycmFkb3IgZXhpc3RlbnRlXG4gICAgICBjb25zdCBkb2NSZWYgPSBhZG1pbkRiLmNvbGxlY3Rpb24oJ3Blcm1pdHMnKS5kb2MoZHJhZnRJZCk7XG4gICAgICBhd2FpdCBkb2NSZWYudXBkYXRlKHsgLi4ucGVybWl0UGF5bG9hZCwgdXBkYXRlZEF0OiBGaWVsZFZhbHVlLnNlcnZlclRpbWVzdGFtcCgpIH0pO1xuICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9wZXJtaXRzLyR7ZHJhZnRJZH1gKTtcbiAgICAgIHJldmFsaWRhdGVQYXRoKCcvcGVybWl0cycpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcGVybWl0SWQ6IGRyYWZ0SWQsIGlzVXBkYXRlOiB0cnVlIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENyZWFyIHVuIG51ZXZvIGJvcnJhZG9yXG4gICAgICBjb25zdCBwYXlsb2FkV2l0aFRpbWVzdGFtcCA9IHsgLi4ucGVybWl0UGF5bG9hZCwgY3JlYXRlZEF0OiBGaWVsZFZhbHVlLnNlcnZlclRpbWVzdGFtcCgpIH07XG4gICAgICBjb25zdCBkb2NSZWYgPSBhd2FpdCBhZG1pbkRiLmNvbGxlY3Rpb24oJ3Blcm1pdHMnKS5hZGQocGF5bG9hZFdpdGhUaW1lc3RhbXAgYXMgYW55KTtcbiAgICAgIHJldmFsaWRhdGVQYXRoKCcvcGVybWl0cycpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcGVybWl0SWQ6IGRvY1JlZi5pZCwgaXNVcGRhdGU6IGZhbHNlIH07XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBbQWN0aW9uXSBFcnJvciBhbCBndWFyZGFyIGJvcnJhZG9yOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnQ291bGQgbm90IHNhdmUgZHJhZnQuIFBsZWFzZSB0cnkgYWdhaW4uJyBcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRTaWduYXR1cmVBbmROb3RpZnkoXG4gIHBlcm1pdElkOiBzdHJpbmcsIFxuICByb2xlOiAnc29saWNpdGFudGUnIHwgJ2F1dG9yaXphbnRlJyB8ICdtYW50ZW5pbWllbnRvJyB8ICdsaWRlcl9zc3QnIHwgJ2Nvb3JkaW5hZG9yX2FsdHVyYXMnIHwgJ2NpZXJyZV9hdXRvcmlkYWQnIHwgJ2NpZXJyZV9yZXNwb25zYWJsZScgfCAnY2FuY2VsYWNpb24nLCBcbiAgc2lnbmF0dXJlVHlwZTogJ2Zpcm1hQXBlcnR1cmEnIHwgJ2Zpcm1hQ2llcnJlJyxcbiAgc2lnbmF0dXJlRGF0YVVybDogc3RyaW5nLFxuICB1c2VyOiB7IHVpZDogc3RyaW5nLCBkaXNwbGF5TmFtZTogc3RyaW5nIHwgbnVsbCwgcm9sZT86IFVzZXJSb2xlLCBlbXByZXNhPzogc3RyaW5nIH0sXG4gIGNvbW1lbnRzPzogc3RyaW5nXG4pIHtcbiAgICBpZiAoIXBlcm1pdElkIHx8ICFyb2xlIHx8ICF1c2VyIHx8ICF1c2VyLnVpZCB8fCAhdXNlci5yb2xlKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1BhcsOhbWV0cm9zIGludsOhbGlkb3MgcGFyYSBndWFyZGFyIGxhIGZpcm1hLicgfTtcbiAgICB9XG4gICAgaWYgKCFpc0FkbWluUmVhZHkoKSkge1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ3JlZGVuY2lhbGVzIGRlIGFkbWluaXN0cmFkb3IgZGUgRmlyZWJhc2Ugbm8gY29uZmlndXJhZGFzIGVuIGVsIHNlcnZpZG9yLicgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBkb2NSZWYgPSBhZG1pbkRiLmNvbGxlY3Rpb24oJ3Blcm1pdHMnKS5kb2MocGVybWl0SWQpO1xuICAgICAgICBjb25zdCBwZXJtaXREb2NCZWZvcmUgPSBhd2FpdCBkb2NSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghcGVybWl0RG9jQmVmb3JlLmV4aXN0cykge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRWwgcGVybWlzbyBubyBleGlzdGUuJyB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBlcm1pdEJlZm9yZURhdGEgPSBwZXJtaXREb2NCZWZvcmUuZGF0YSgpIGFzIFBlcm1pdDtcblxuICAgICAgICBjb25zdCB1cGRhdGVEYXRhOiBVcGRhdGVEYXRhPFBlcm1pdD4gPSB7fTtcblxuICAgICAgICAvLyBMw7NnaWNhIHBhcmEgbWFuZWphciBmaXJtYXMgZGUgY2llcnJlIHkgY2FuY2VsYWNpw7NuXG4gICAgICAgIGlmIChyb2xlLnN0YXJ0c1dpdGgoJ2NpZXJyZV8nKSB8fCByb2xlID09PSAnY2FuY2VsYWNpb24nKSB7XG4gICAgICAgICAgICBjb25zdCBjbG9zdXJlUm9sZSA9IHJvbGUgPT09ICdjaWVycmVfYXV0b3JpZGFkJyA/ICdhdXRvcmlkYWQnIDogKHJvbGUgPT09ICdjaWVycmVfcmVzcG9uc2FibGUnID8gJ3Jlc3BvbnNhYmxlJyA6ICdjYW5jZWxhZG9Qb3InKTtcbiAgICAgICAgICAgIGNvbnN0IGNsb3N1cmVQYXRoID0gYGNsb3N1cmUuJHtjbG9zdXJlUm9sZX1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0Nsb3N1cmVEYXRhID0gKHBlcm1pdEJlZm9yZURhdGEuY2xvc3VyZSBhcyBhbnkpPy5bY2xvc3VyZVJvbGVdIHx8IHt9O1xuXG4gICAgICAgICAgICB1cGRhdGVEYXRhW2Nsb3N1cmVQYXRoIGFzIGtleW9mIFVwZGF0ZURhdGE8UGVybWl0Pl0gPSB7XG4gICAgICAgICAgICAgICAgLi4uZXhpc3RpbmdDbG9zdXJlRGF0YSxcbiAgICAgICAgICAgICAgICBmaXJtYTogc2lnbmF0dXJlRGF0YVVybCxcbiAgICAgICAgICAgICAgICBub21icmU6IHVzZXIuZGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgZmVjaGE6IEZpZWxkVmFsdWUuc2VydmVyVGltZXN0YW1wKCkgXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocm9sZSA9PT0gJ2NhbmNlbGFjaW9uJykge1xuICAgICAgICAgICAgICAgIHVwZGF0ZURhdGFbJ2Nsb3N1cmUucmF6b25DYW5jZWxhY2lvbiddID0gY29tbWVudHMgfHwgJ05vIGVzcGVjaWZpY2Fkbyc7XG4gICAgICAgICAgICAgICAgdXBkYXRlRGF0YVsnY2xvc3VyZS5jYW5jZWxhZG8nXSA9ICdzaSc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIOKchSBWQUxJREFDScOTTiBERSBQRVJNSVNPUyBBTlRFUyBERSBGSVJNQVJcbiAgICAgICAgICAgIGNvbnN0IGNhblNpZ24gPSBhd2FpdCB2YWxpZGF0ZVNpZ25hdHVyZVBlcm1pc3Npb24ocGVybWl0SWQsIHJvbGUsIHVzZXIpO1xuICAgICAgICAgICAgaWYgKCFjYW5TaWduLmFsbG93ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGNhblNpZ24ucmVhc29uIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGFwcHJvdmFsRGF0YTogUGFydGlhbDxBcHByb3ZhbD4gPSB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAnYXByb2JhZG8nLFxuICAgICAgICAgICAgICAgIGZpcm1hQXBlcnR1cmE6IHNpZ25hdHVyZURhdGFVcmwsXG4gICAgICAgICAgICAgICAgdXNlck5hbWU6IHVzZXIuZGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcklkOiB1c2VyLnVpZCxcbiAgICAgICAgICAgICAgICBzaWduZWRBdDogRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKSBhcyBhbnksXG4gICAgICAgICAgICAgICAgdXNlclJvbGU6IHVzZXIucm9sZSxcbiAgICAgICAgICAgICAgICB1c2VyRW1wcmVzYTogdXNlci5lbXByZXNhIHx8ICdOL0EnLFxuICAgICAgICAgICAgICAgIGNvbW1lbnRzOiBjb21tZW50cyB8fCAnJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdXBkYXRlRGF0YVtgYXBwcm92YWxzLiR7cm9sZX1gXSA9IGFwcHJvdmFsRGF0YTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8g4pyFIEzDk0dJQ0EgREUgRklSTUFTIFNFR8OaTiBFTCBST0xcbiAgICAgICAgICAgIGlmIChzaWduYXR1cmVUeXBlID09PSAnZmlybWFBcGVydHVyYScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWxpZGF0aW9uUGF5bG9hZDogVmFsaWRhY2lvbkRpYXJpYSA9IHsgXG4gICAgICAgICAgICAgICAgICAgIGRpYTogMSwgXG4gICAgICAgICAgICAgICAgICAgIG5vbWJyZTogdXNlci5kaXNwbGF5TmFtZSB8fCAnJywgXG4gICAgICAgICAgICAgICAgICAgIGZpcm1hOiBzaWduYXR1cmVEYXRhVXJsLCBcbiAgICAgICAgICAgICAgICAgICAgZmVjaGE6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSBcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIOKchSBTT0xJQ0lUQU5URSBGSVJNQTogQ2FtYmlhIGRlIEJvcnJhZG9yIGEgUGVuZGllbnRlIGRlIFJldmlzacOzblxuICAgICAgICAgICAgICAgIGlmIChyb2xlID09PSAnc29saWNpdGFudGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwZXJtaXRCZWZvcmVEYXRhLnN0YXR1cyA9PT0gJ2JvcnJhZG9yJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVybWl0TnVtYmVyID0gYFBULSR7RGF0ZS5ub3coKX0tJHtwZXJtaXRJZC5zdWJzdHJpbmcoMCwgNikudG9VcHBlckNhc2UoKX1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YVsnbnVtYmVyJ10gPSBwZXJtaXROdW1iZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVEYXRhWydzdGF0dXMnXSA9ICdwZW5kaWVudGVfcmV2aXNpb24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBWYWxpZGFjacOzbiBkaWFyaWEgaW5pY2lhbCBkZWwgcmVzcG9uc2FibGVcbiAgICAgICAgICAgICAgICAgICAgWydhbmV4b0FsdHVyYScsICdhbmV4b0NvbmZpbmFkbycsICdhbmV4b0l6YWplJywgJ2FuZXhvRXhjYXZhY2lvbmVzJ10uZm9yRWFjaChhbmV4byA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHBlcm1pdEJlZm9yZURhdGEgYXMgYW55KT8uW2FuZXhvXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWxpZGF0aW9ucyA9IChwZXJtaXRCZWZvcmVEYXRhIGFzIGFueSlbYW5leG9dLnZhbGlkYWNpb24/LnJlc3BvbnNhYmxlIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudFZhbGlkYXRpb25zWzBdPy5maXJtYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VmFsaWRhdGlvbnNbMF0gPSB2YWxpZGF0aW9uUGF5bG9hZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YVtgJHthbmV4b30udmFsaWRhY2lvbi5yZXNwb25zYWJsZWBdID0gY3VycmVudFZhbGlkYXRpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyDinIUgQVVUT1JJWkFOVEUgRklSTUE6IEFncmVnYSB2YWxpZGFjacOzbiBkaWFyaWEgZGUgYXV0b3JpZGFkXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyb2xlID09PSAnYXV0b3JpemFudGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIFsnYW5leG9BbHR1cmEnLCAnYW5leG9Db25maW5hZG8nLCAnYW5leG9JemFqZScsICdhbmV4b0V4Y2F2YWNpb25lcyddLmZvckVhY2goYW5leG8gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChwZXJtaXRCZWZvcmVEYXRhIGFzIGFueSk/LlthbmV4b10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWxpZGF0aW9ucyA9IChwZXJtaXRCZWZvcmVEYXRhIGFzIGFueSlbYW5leG9dLnZhbGlkYWNpb24/LmF1dG9yaWRhZCB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRWYWxpZGF0aW9uc1swXT8uZmlybWEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhbGlkYXRpb25zWzBdID0gdmFsaWRhdGlvblBheWxvYWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGFbYCR7YW5leG99LnZhbGlkYWNpb24uYXV0b3JpZGFkYF0gPSBjdXJyZW50VmFsaWRhdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIOKchSBWRVJJRklDQUNJw5NOIEFVVE9Nw4FUSUNBOiDCv1RvZGFzIGxhcyBmaXJtYXMgcmVxdWVyaWRhcyBlc3TDoW4gY29tcGxldGFzP1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFBlcm1pdERhdGEgPSB7IFxuICAgICAgICAgICAgICAgIC4uLnBlcm1pdEJlZm9yZURhdGEsIFxuICAgICAgICAgICAgICAgIGFwcHJvdmFsczogeyAuLi5wZXJtaXRCZWZvcmVEYXRhLmFwcHJvdmFscywgW3JvbGVdOiBhcHByb3ZhbERhdGEgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGF3YWl0IGNoZWNrQWxsUmVxdWlyZWRTaWduYXR1cmVzQ29tcGxldGUodXBkYXRlZFBlcm1pdERhdGEpKSB7XG4gICAgICAgICAgICAgICAgLy8g8J+agCBDQU1CSU8gQVVUT03DgVRJQ08gREUgUEVORElFTlRFX1JFVklTSU9OIOKGkiBFTl9FSkVDVUNJT05cbiAgICAgICAgICAgICAgICBpZiAocGVybWl0QmVmb3JlRGF0YS5zdGF0dXMgPT09ICdwZW5kaWVudGVfcmV2aXNpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGFbJ3N0YXR1cyddID0gJ2VuX2VqZWN1Y2lvbic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCBkb2NSZWYudXBkYXRlKHVwZGF0ZURhdGEpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcGVybWl0RG9jID0gYXdhaXQgZG9jUmVmLmdldCgpO1xuICAgICAgICBjb25zdCB1cGRhdGVkUGVybWl0RGF0YSA9IHsgaWQ6IHBlcm1pdERvYy5pZCwgLi4ucGVybWl0RG9jLmRhdGEoKSB9IGFzIFBlcm1pdDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZVJvbGVOYW1lID0gKHNpZ25hdHVyZVJvbGVzIGFzIGFueSlbcm9sZV0gfHwgcm9sZS5yZXBsYWNlKCdfJywgJyAnKS5yZXBsYWNlKC9cXGJcXHcvZywgbCA9PiBsLnRvVXBwZXJDYXNlKCkpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGAke3VzZXIuZGlzcGxheU5hbWUgfHwgJ1VuIHVzdWFyaW8nfSBoYSBmaXJtYWRvIGVsIHBlcm1pc28gIyR7dXBkYXRlZFBlcm1pdERhdGEubnVtYmVyfSBjb21vICR7c2lnbmF0dXJlUm9sZU5hbWV9LmA7XG4gICAgICAgIGNvbnN0IGludm9sdmVkVXNlcnMgPSBhd2FpdCBnZXRJbnZvbHZlZFVzZXJzKHVwZGF0ZWRQZXJtaXREYXRhKTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgdWlkIG9mIGludm9sdmVkVXNlcnMpIHtcbiAgICAgICAgICBpZiAodWlkICE9PSB1c2VyLnVpZCkge1xuICAgICAgICAgICAgYXdhaXQgY3JlYXRlTm90aWZpY2F0aW9uKHVpZCwgdXBkYXRlZFBlcm1pdERhdGEsIG1lc3NhZ2UsICdzaWduYXR1cmUnLCB1c2VyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIOKchSBOT1RJRklDQUNJw5NOIEVTUEVDSUFMIFNJIEVMIFBFUk1JU08gUEFTw5MgQVVUT03DgVRJQ0FNRU5URSBBIEVOX0VKRUNVQ0lPTlxuICAgICAgICBpZiAodXBkYXRlRGF0YVsnc3RhdHVzJ10gPT09ICdlbl9lamVjdWNpb24nKSB7XG4gICAgICAgICAgICBjb25zdCBleGVjdXRpb25NZXNzYWdlID0gYEVsIHBlcm1pc28gIyR7dXBkYXRlZFBlcm1pdERhdGEubnVtYmVyfSBoYSBjb21wbGV0YWRvIHRvZGFzIGxhcyBhcHJvYmFjaW9uZXMgcmVxdWVyaWRhcyB5IGFob3JhIGVzdMOhIEVOIEVKRUNVQ0nDk04uYDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdWlkIG9mIGludm9sdmVkVXNlcnMpIHtcbiAgICAgICAgICAgICAgICAgYXdhaXQgY3JlYXRlTm90aWZpY2F0aW9uKHVpZCwgdXBkYXRlZFBlcm1pdERhdGEsIGV4ZWN1dGlvbk1lc3NhZ2UsICdhcHByb3ZhbCcsIHVzZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBOb3RpZmljYWNpw7NuIFdoYXRzQXBwXG4gICAgICAgICAgICBjb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkwgfHwgJ2h0dHBzOi8vc2dwdC1tb3ZpbC53ZWIuYXBwJztcbiAgICAgICAgICAgIGNvbnN0IHBlcm1pdFVybCA9IGAke2Jhc2VVcmx9L3Blcm1pdHMvJHtwZXJtaXRJZH1gO1xuICAgICAgICAgICAgY29uc3Qgd2hhdHNhcHBNc2cgPSBgKsKhUEVSTUlTTyBFTiBFSkVDVUNJw5NOISog4pyFXG5cbvCfk4QgKk7Dum1lcm86KiAke3VwZGF0ZWRQZXJtaXREYXRhLm51bWJlcn1cbvCfk40gKsOBcmVhOiogJHtwZXJtaXRCZWZvcmVEYXRhLmdlbmVyYWxJbmZvPy5hcmVhRXNwZWNpZmljYSB8fCAnTi9BJ31cbvCfm6DvuI8gKlRpcG86KiAke2dldFdvcmtUeXBlc1N0cmluZyhwZXJtaXRCZWZvcmVEYXRhKX1cblxu4pyFIFRvZGFzIGxhcyBmaXJtYXMgcmVxdWVyaWRhcyBoYW4gc2lkbyBjb21wbGV0YWRhcy5cbkVsIHBlcm1pc28gZXN0w6EgYWhvcmEgRU4gRUpFQ1VDScOTTi5cblxuVmVyIGRldGFsbGVzOiAke3Blcm1pdFVybH1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhd2FpdCBzZW5kV2hhdHNBcHBOb3RpZmljYXRpb24od2hhdHNhcHBNc2cpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9wZXJtaXRzLyR7cGVybWl0SWR9YCk7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBhbCBndWFyZGFyIGZpcm1hIHkgbm90aWZpY2FyOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdObyBzZSBwdWRvIGd1YXJkYXIgbGEgZmlybWEuJ1xuICAgICAgICB9O1xuICAgIH1cbn1cblxuLy8g4pyFIEZVTkNJw5NOIENPUlJFR0lEQTogVmVyaWZpY2FyIHNpIHRvZGFzIGxhcyBmaXJtYXMgcmVxdWVyaWRhcyBlc3TDoW4gY29tcGxldGFzXG5hc3luYyBmdW5jdGlvbiBjaGVja0FsbFJlcXVpcmVkU2lnbmF0dXJlc0NvbXBsZXRlKFxuICBwZXJtaXREYXRhOiBQZXJtaXRcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHsgYXBwcm92YWxzIH0gPSBwZXJtaXREYXRhO1xuICAgIFxuICAgIC8vIEZpcm1hIGRlbCBzb2xpY2l0YW50ZSBlcyBTSUVNUFJFIHJlcXVlcmlkYVxuICAgIGlmIChhcHByb3ZhbHM/LnNvbGljaXRhbnRlPy5zdGF0dXMgIT09ICdhcHJvYmFkbycpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBGaXJtYSBkZWwgYXV0b3JpemFudGUgZXMgU0lFTVBSRSByZXF1ZXJpZGFcbiAgICBpZiAoYXBwcm92YWxzPy5hdXRvcml6YW50ZT8uc3RhdHVzICE9PSAnYXByb2JhZG8nKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgLy8gU2kgaGF5IHRyYWJham9zIGVuIGFsdHVyYXMsIHJlcXVpZXJlIGZpcm1hIGRlbCBjb29yZGluYWRvclxuICAgIGlmIChwZXJtaXREYXRhLnRyYWJham9BbHR1cmFzIHx8IHBlcm1pdERhdGEuc2VsZWN0ZWRXb3JrVHlwZXM/LmFsdHVyYXMpIHtcbiAgICAgICAgaWYgKGFwcHJvdmFscz8uY29vcmRpbmFkb3JfYWx0dXJhcz8uc3RhdHVzICE9PSAnYXByb2JhZG8nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gU2kgaGF5IGNvbnRyb2wgZGUgZW5lcmfDrWEsIHJlcXVpZXJlIGZpcm1hIGRlIG1hbnRlbmltaWVudG9cbiAgICBpZiAocGVybWl0RGF0YS5jb250cm9sRW5lcmdpYSkge1xuICAgICAgICBpZiAoYXBwcm92YWxzPy5tYW50ZW5pbWllbnRvPy5zdGF0dXMgIT09ICdhcHJvYmFkbycpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBTaSBTU1QgZXMgcmVxdWVyaWRvLCB2YWxpZGFyIHN1IGZpcm1hXG4gICAgaWYgKHBlcm1pdERhdGEuaXNTU1RTaWduYXR1cmVSZXF1aXJlZCkge1xuICAgICAgICBpZiAoYXBwcm92YWxzPy5saWRlcl9zc3Q/LnN0YXR1cyAhPT0gJ2Fwcm9iYWRvJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0cnVlO1xufVxuXG4vLyDinIUgRlVOQ0nDk04gTUVKT1JBREE6IFZhbGlkYWNpw7NuIGRlIHRyYW5zaWNpb25lcyBkZSBlc3RhZG9cbmZ1bmN0aW9uIHZhbGlkYXRlU3RhdGVUcmFuc2l0aW9uKGN1cnJlbnRTdGF0dXM6IFBlcm1pdFN0YXR1cywgdGFyZ2V0U3RhdHVzOiBQZXJtaXRTdGF0dXMsIHVzZXJSb2xlOiBVc2VyUm9sZSk6IHsgYWxsb3dlZDogYm9vbGVhbiwgcmVhc29uPzogc3RyaW5nIH0ge1xuICAgIGNvbnN0IGFsbG93ZWRUcmFuc2l0aW9uczogUGFydGlhbDxSZWNvcmQ8UGVybWl0U3RhdHVzLCBQYXJ0aWFsPFJlY29yZDxQZXJtaXRTdGF0dXMsIFVzZXJSb2xlW10+Pj4+ID0ge1xuICAgICAgICAnYm9ycmFkb3InOiB7XG4gICAgICAgICAgICAncGVuZGllbnRlX3JldmlzaW9uJzogWydzb2xpY2l0YW50ZScsICdsaWRlcl90YXJlYScsICdhZG1pbiddXG4gICAgICAgIH0sXG4gICAgICAgICdwZW5kaWVudGVfcmV2aXNpb24nOiB7XG4gICAgICAgICAgICAnZW5fZWplY3VjaW9uJzogWydhdXRvcml6YW50ZScsICdhZG1pbiddLFxuICAgICAgICAgICAgJ3JlY2hhemFkbyc6IFsnYXV0b3JpemFudGUnLCAnbGlkZXJfc3N0JywgJ2FkbWluJ11cbiAgICAgICAgfSxcbiAgICAgICAgJ2VuX2VqZWN1Y2lvbic6IHtcbiAgICAgICAgICAgICdzdXNwZW5kaWRvJzogWydsaWRlcl9zc3QnLCAnYWRtaW4nXSxcbiAgICAgICAgICAgICdjZXJyYWRvJzogWydsaWRlcl90YXJlYScsICdhdXRvcml6YW50ZScsICdhZG1pbiddXG4gICAgICAgIH0sXG4gICAgICAgICdzdXNwZW5kaWRvJzoge1xuICAgICAgICAgICAgJ2VuX2VqZWN1Y2lvbic6IFsnbGlkZXJfc3N0JywgJ2FkbWluJ10sXG4gICAgICAgICAgICAnY2VycmFkbyc6IFsnbGlkZXJfdGFyZWEnLCAnYXV0b3JpemFudGUnLCAnYWRtaW4nXVxuICAgICAgICB9LFxuICAgICAgICAvLyBNYW50ZW5lciBjb21wYXRpYmlsaWRhZCBjb24gcGVybWlzb3MgYW50aWd1b3MgcXVlIHRlbmdhbiBlc3RhZG8gXCJhcHJvYmFkb1wiXG4gICAgICAgICdhcHJvYmFkbyc6IHtcbiAgICAgICAgICAgICdlbl9lamVjdWNpb24nOiBbJ2xpZGVyX3RhcmVhJywgJ2FkbWluJ10sXG4gICAgICAgICAgICAncmVjaGF6YWRvJzogWydhdXRvcml6YW50ZScsICdsaWRlcl9zc3QnLCAnYWRtaW4nXVxuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICBjb25zdCBhbGxvd2VkUm9sZXMgPSBhbGxvd2VkVHJhbnNpdGlvbnNbY3VycmVudFN0YXR1c10/Llt0YXJnZXRTdGF0dXNdO1xuICAgIGlmICghYWxsb3dlZFJvbGVzKSB7XG4gICAgICAgIHJldHVybiB7IGFsbG93ZWQ6IGZhbHNlLCByZWFzb246IGBUcmFuc2ljacOzbiBkZSAnJHtjdXJyZW50U3RhdHVzfScgYSAnJHt0YXJnZXRTdGF0dXN9JyBubyBlc3TDoSBwZXJtaXRpZGEuYCB9O1xuICAgIH1cblxuICAgIGlmICghYWxsb3dlZFJvbGVzLmluY2x1ZGVzKHVzZXJSb2xlKSAmJiB1c2VyUm9sZSAhPT0gJ2FkbWluJykge1xuICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiBgVHUgcm9sICgke3VzZXJSb2xlfSkgbm8gdGllbmUgcGVybWlzb3MgcGFyYSBjYW1iaWFyIGVsIGVzdGFkbyBhICcke3RhcmdldFN0YXR1c30nLmAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQZXJtaXRTdGF0dXMoXG4gIHBlcm1pdElkOiBzdHJpbmcsXG4gIHN0YXR1czogUGVybWl0U3RhdHVzLFxuICBjdXJyZW50VXNlcjogeyB1aWQ6IHN0cmluZywgZGlzcGxheU5hbWU6IHN0cmluZyB8IG51bGwsIHJvbGU/OiBVc2VyUm9sZSB9LFxuICByZWFzb24/OiBzdHJpbmdcbikge1xuICAgIGlmICghcGVybWl0SWQgfHwgIWN1cnJlbnRVc2VyLnVpZCB8fCAhY3VycmVudFVzZXIucm9sZSkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdQYXLDoW1ldHJvcyBpbnbDoWxpZG9zIG8gdXN1YXJpbyBzaW4gcm9sLicgfTtcbiAgICB9XG4gICAgaWYgKCFpc0FkbWluUmVhZHkoKSkge1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ3JlZGVuY2lhbGVzIGRlIGFkbWluaXN0cmFkb3IgZGUgRmlyZWJhc2Ugbm8gY29uZmlndXJhZGFzLicgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBkb2NSZWYgPSBhZG1pbkRiLmNvbGxlY3Rpb24oJ3Blcm1pdHMnKS5kb2MocGVybWl0SWQpO1xuICAgICAgICBjb25zdCBwZXJtaXRTbmFwID0gYXdhaXQgZG9jUmVmLmdldCgpO1xuICAgICAgICBpZiAoIXBlcm1pdFNuYXAuZXhpc3RzKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdFbCBwZXJtaXNvIG5vIGV4aXN0ZS4nIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGVybWl0RGF0YSA9IHBlcm1pdFNuYXAuZGF0YSgpIGFzIFBlcm1pdDtcbiAgICAgICAgXG4gICAgICAgIC8vIOKchSBWYWxpZGFyIHRyYW5zaWNpw7NuIGRlIGVzdGFkb1xuICAgICAgICBjb25zdCB0cmFuc2l0aW9uID0gdmFsaWRhdGVTdGF0ZVRyYW5zaXRpb24ocGVybWl0RGF0YS5zdGF0dXMsIHN0YXR1cywgY3VycmVudFVzZXIucm9sZSk7XG4gICAgICAgIGlmICghdHJhbnNpdGlvbi5hbGxvd2VkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHRyYW5zaXRpb24ucmVhc29uIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1cGRhdGVEYXRhOiBVcGRhdGVEYXRhPFBlcm1pdD4gPSB7IHN0YXR1cyB9O1xuXG4gICAgICAgIC8vIOKchSBHdWFyZGFyIHJhesOzbiBkZSByZWNoYXpvXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdyZWNoYXphZG8nICYmIHJlYXNvbikge1xuICAgICAgICAgICAgdXBkYXRlRGF0YS5yZWplY3Rpb25SZWFzb24gPSByZWFzb247XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIOKchSBNYXJjYXIgZmVjaGEgZGUgY2llcnJlXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdjZXJyYWRvJykge1xuICAgICAgICAgICAgdXBkYXRlRGF0YVsnY2xvc3VyZS5mZWNoYUNpZXJyZSddID0gRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKTtcbiAgICAgICAgICAgIHVwZGF0ZURhdGFbJ2Nsb3N1cmUudGVybWluYWRvJ10gPSAnc2knO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgZG9jUmVmLnVwZGF0ZSh1cGRhdGVEYXRhKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRQZXJtaXREYXRhID0geyAuLi5wZXJtaXREYXRhLCAuLi51cGRhdGVEYXRhLCBpZDogcGVybWl0SWQgfSBhcyBQZXJtaXQ7XG4gICAgICAgIGNvbnN0IHRyaWdnZXJlZEJ5ID0gY3VycmVudFVzZXI7XG4gICAgICAgIFxuICAgICAgICBsZXQgbm90aWZpY2F0aW9uVHlwZTogTm90aWZpY2F0aW9uWyd0eXBlJ10gPSAnc3RhdHVzX2NoYW5nZSc7XG4gICAgICAgIGxldCBtZXNzYWdlID0gYCR7Y3VycmVudFVzZXIuZGlzcGxheU5hbWUgfHwgJ1VuIHVzdWFyaW8nfSBoYSBjYW1iaWFkbyBlbCBlc3RhZG8gZGVsIHBlcm1pc28gIyR7cGVybWl0RGF0YS5udW1iZXJ9IGE6ICR7Z2V0U3RhdHVzVGV4dChzdGF0dXMpfS5gO1xuXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdlbl9lamVjdWNpb24nKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25UeXBlID0gJ2FwcHJvdmFsJztcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgRWwgcGVybWlzbyAjJHtwZXJtaXREYXRhLm51bWJlcn0gaGEgc2lkbyBwdWVzdG8gRU4gRUpFQ1VDScOTTiBtYW51YWxtZW50ZS5gO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gJ3JlY2hhemFkbycpIHtcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvblR5cGUgPSAncmVqZWN0aW9uJztcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgJHtjdXJyZW50VXNlci5kaXNwbGF5TmFtZSB8fCAnVW4gdXN1YXJpbyd9IGhhIHJlY2hhemFkbyBlbCBwZXJtaXNvICMke3Blcm1pdERhdGEubnVtYmVyfS5gO1xuICAgICAgICAgICAgaWYgKHJlYXNvbikgbWVzc2FnZSArPSBgIE1vdGl2bzogJHtyZWFzb259YDtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICdjZXJyYWRvJykge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uVHlwZSA9ICdjYW5jZWxsYXRpb24nO1xuICAgICAgICAgICAgbWVzc2FnZSA9IGAke2N1cnJlbnRVc2VyLmRpc3BsYXlOYW1lIHx8ICdVbiB1c3VhcmlvJ30gaGEgY2VycmFkbyBlbCBwZXJtaXNvICMke3Blcm1pdERhdGEubnVtYmVyfS5gO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBpbnZvbHZlZFVzZXJzID0gYXdhaXQgZ2V0SW52b2x2ZWRVc2Vycyh1cGRhdGVkUGVybWl0RGF0YSk7XG4gICAgICAgIGZvciAoY29uc3QgdWlkIG9mIGludm9sdmVkVXNlcnMpIHtcbiAgICAgICAgICAgICBpZiAodWlkICE9PSBjdXJyZW50VXNlci51aWQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBjcmVhdGVOb3RpZmljYXRpb24odWlkLCB1cGRhdGVkUGVybWl0RGF0YSwgbWVzc2FnZSwgbm90aWZpY2F0aW9uVHlwZSwgdHJpZ2dlcmVkQnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMIHx8ICdodHRwczovL3NncHQtbW92aWwud2ViLmFwcCc7XG4gICAgICAgIGNvbnN0IHBlcm1pdFVybCA9IGAke2Jhc2VVcmx9L3Blcm1pdHMvJHtwZXJtaXRJZH1gO1xuXG4gICAgICAgIGxldCBtZXNzYWdlQm9keSA9IGAqQWN0dWFsaXphY2nDs24gZGUgRXN0YWRvIC0gU0dUQyog8J+UhFxuRWwgZXN0YWRvIGRlbCBwZXJtaXNvICoke3Blcm1pdERhdGEubnVtYmVyIHx8IHBlcm1pdElkfSogaGEgY2FtYmlhZG8uXG5cbipOdWV2byBFc3RhZG86KiAke2dldFN0YXR1c1RleHQoc3RhdHVzKX1cblxuUHVlZGUgdmVyIGxvcyBkZXRhbGxlcyBhcXXDrTpcbiR7cGVybWl0VXJsfWA7XG5cbiAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ3JlY2hhemFkbycgJiYgcmVhc29uKSB7XG4gICAgICAgICAgbWVzc2FnZUJvZHkgKz0gYFxcblxcbipNb3Rpdm8gZGVsIHJlY2hhem86KiAke3JlYXNvbn1gO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhd2FpdCBzZW5kV2hhdHNBcHBOb3RpZmljYXRpb24obWVzc2FnZUJvZHkpO1xuICAgICAgICBcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9wZXJtaXRzLyR7cGVybWl0SWR9YCk7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvcGVybWl0cycpO1xuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2Rhc2hib2FyZCcpO1xuXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRXJyb3IgdXBkYXRpbmcgcGVybWl0IHN0YXR1czpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnQ291bGQgbm90IHVwZGF0ZSBwZXJtaXQgc3RhdHVzLidcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8vIOKchSBGVU5DScOTTiBNRUpPUkFEQTogVmFsaWRhY2nDs24gZGUgcGVybWlzb3MgZGUgZmlybWEgY29uIG9yZGVuIGplcsOhcnF1aWNvXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVNpZ25hdHVyZVBlcm1pc3Npb24oXG4gICAgcGVybWl0SWQ6IHN0cmluZywgXG4gICAgc2lnbmF0dXJlUm9sZTogc3RyaW5nLCBcbiAgICBjdXJyZW50VXNlcjogeyB1aWQ6IHN0cmluZywgcm9sZT86IFVzZXJSb2xlIH1cbik6IFByb21pc2U8eyBhbGxvd2VkOiBib29sZWFuLCByZWFzb24/OiBzdHJpbmcgfT4ge1xuICAgIGNvbnN0IGRvY1JlZiA9IGFkbWluRGIuY29sbGVjdGlvbigncGVybWl0cycpLmRvYyhwZXJtaXRJZCk7XG4gICAgY29uc3QgcGVybWl0RG9jID0gYXdhaXQgZG9jUmVmLmdldCgpO1xuICAgIGlmICghcGVybWl0RG9jLmV4aXN0cykge1xuICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiAnUGVybWlzbyBubyBlbmNvbnRyYWRvLicgfTtcbiAgICB9XG4gICAgY29uc3QgcGVybWl0ID0gcGVybWl0RG9jLmRhdGEoKSBhcyBQZXJtaXQ7XG4gICAgXG4gICAgLy8g4pyFIFZlcmlmaWNhciBxdWUgZWwgcGVybWlzbyBlc3TDqSBlbiB1biBlc3RhZG8gdsOhbGlkbyBwYXJhIGZpcm1hclxuICAgIGlmICghWydib3JyYWRvcicsICdwZW5kaWVudGVfcmV2aXNpb24nXS5pbmNsdWRlcyhwZXJtaXQuc3RhdHVzKSkge1xuICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiBgTm8gc2UgcHVlZGUgZmlybWFyIHVuIHBlcm1pc28gZW4gZXN0YWRvICcke3Blcm1pdC5zdGF0dXN9Jy5gIH07XG4gICAgfVxuICAgIFxuICAgIHN3aXRjaCAoc2lnbmF0dXJlUm9sZSkge1xuICAgICAgICBjYXNlICdjb29yZGluYWRvcl9hbHR1cmFzJzpcbiAgICAgICAgICAgIC8vIERlYmUgaGFiZXIgdHJhYmFqbyBlbiBhbHR1cmFzXG4gICAgICAgICAgICBpZiAoIXBlcm1pdC50cmFiYWpvQWx0dXJhcyAmJiAhcGVybWl0LnNlbGVjdGVkV29ya1R5cGVzPy5hbHR1cmFzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogZmFsc2UsIHJlYXNvbjogJ0VzdGEgZmlybWEgc29sbyBhcGxpY2EgcGFyYSB0cmFiYWpvcyBlbiBhbHR1cmFzLicgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFNvbG8gZWwgY3JlYWRvciBvIGFkbWluIHB1ZWRlIGdlc3Rpb25hciBlc3RhIGZpcm1hXG4gICAgICAgICAgICBpZiAocGVybWl0LmNyZWF0ZWRCeSAhPT0gY3VycmVudFVzZXIudWlkICYmIGN1cnJlbnRVc2VyLnJvbGUgIT09ICdhZG1pbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiAnU29sbyBlbCBjcmVhZG9yIGRlbCBwZXJtaXNvIHB1ZWRlIGdlc3Rpb25hciBlc3RhIGZpcm1hLicgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgXG4gICAgICAgIGNhc2UgJ3NvbGljaXRhbnRlJzpcbiAgICAgICAgICAgIGlmIChwZXJtaXQuY3JlYXRlZEJ5ICE9PSBjdXJyZW50VXNlci51aWQgJiYgY3VycmVudFVzZXIucm9sZSAhPT0gJ2FkbWluJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGFsbG93ZWQ6IGZhbHNlLCByZWFzb246ICdTb2xvIGVsIGNyZWFkb3IgZGVsIHBlcm1pc28gcHVlZGUgZmlybWFyIGNvbW8gc29saWNpdGFudGUuJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8g4pyFIFNpIGhheSBhbmV4byBkZSBhbHR1cmFzLCB2ZXJpZmljYXIgZmlybWEgZGVsIGNvb3JkaW5hZG9yIHByaW1lcm9cbiAgICAgICAgICAgIGlmICgocGVybWl0LnRyYWJham9BbHR1cmFzIHx8IHBlcm1pdC5zZWxlY3RlZFdvcmtUeXBlcz8uYWx0dXJhcykgJiYgXG4gICAgICAgICAgICAgICAgcGVybWl0LmFwcHJvdmFscz8uY29vcmRpbmFkb3JfYWx0dXJhcz8uc3RhdHVzICE9PSAnYXByb2JhZG8nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogZmFsc2UsIHJlYXNvbjogJ1NlIHJlcXVpZXJlIHByaW1lcm8gbGEgZmlybWEgZGVsIENvb3JkaW5hZG9yIGRlIFRyYWJham9zIGVuIEFsdHVyYXMuJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBcbiAgICAgICAgY2FzZSAnYXV0b3JpemFudGUnOlxuICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2VyLnJvbGUgIT09ICdhdXRvcml6YW50ZScgJiYgY3VycmVudFVzZXIucm9sZSAhPT0gJ2FkbWluJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGFsbG93ZWQ6IGZhbHNlLCByZWFzb246ICdSb2wgZGUgYXV0b3JpemFudGUgcmVxdWVyaWRvIHBhcmEgZXN0YSBmaXJtYS4nIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGVybWl0LmFwcHJvdmFscz8uc29saWNpdGFudGU/LnN0YXR1cyAhPT0gJ2Fwcm9iYWRvJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGFsbG93ZWQ6IGZhbHNlLCByZWFzb246ICdTZSByZXF1aWVyZSBwcmltZXJvIGxhIGZpcm1hIGRlbCBzb2xpY2l0YW50ZS4nIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIFxuICAgICAgICBjYXNlICdsaWRlcl9zc3QnOlxuICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2VyLnJvbGUgIT09ICdsaWRlcl9zc3QnICYmIGN1cnJlbnRVc2VyLnJvbGUgIT09ICdhZG1pbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiAnUm9sIGRlIEzDrWRlciBTU1QgcmVxdWVyaWRvIHBhcmEgZXN0YSBmaXJtYS4nIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDinIUgU29sbyByZXF1ZXJpZG8gc2kgaXNTU1RTaWduYXR1cmVSZXF1aXJlZCBlcyB0cnVlXG4gICAgICAgICAgICBpZiAoIXBlcm1pdC5pc1NTVFNpZ25hdHVyZVJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogZmFsc2UsIHJlYXNvbjogJ0Zpcm1hIGRlIFNTVCBubyBlcyByZXF1ZXJpZGEgcGFyYSBlc3RlIHBlcm1pc28uJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBlcm1pdC5hcHByb3ZhbHM/LnNvbGljaXRhbnRlPy5zdGF0dXMgIT09ICdhcHJvYmFkbycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiAnU2UgcmVxdWllcmUgcHJpbWVybyBsYSBmaXJtYSBkZWwgc29saWNpdGFudGUuJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBcbiAgICAgICAgY2FzZSAnbWFudGVuaW1pZW50byc6XG4gICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2VyLnJvbGUgIT09ICdtYW50ZW5pbWllbnRvJyAmJiBjdXJyZW50VXNlci5yb2xlICE9PSAnYWRtaW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogZmFsc2UsIHJlYXNvbjogJ1JvbCBkZSBNYW50ZW5pbWllbnRvIHJlcXVlcmlkbyBwYXJhIGVzdGEgZmlybWEuJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFwZXJtaXQuY29udHJvbEVuZXJnaWEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiAnRmlybWEgZGUgTWFudGVuaW1pZW50byBzb2xvIGFwbGljYSBjdWFuZG8gaGF5IGNvbnRyb2wgZGUgZW5lcmfDrWFzLicgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwZXJtaXQuYXBwcm92YWxzPy5hdXRvcml6YW50ZT8uc3RhdHVzICE9PSAnYXByb2JhZG8nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgYWxsb3dlZDogZmFsc2UsIHJlYXNvbjogJ1NlIHJlcXVpZXJlIHByaW1lcm8gbGEgZmlybWEgZGVsIGF1dG9yaXphbnRlLicgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGREYWlseVZhbGlkYXRpb25TaWduYXR1cmUoXG4gIHBlcm1pdElkOiBzdHJpbmcsIFxuICBhbmV4b05hbWU6IHN0cmluZywgXG4gIHZhbGlkYXRpb25UeXBlOiAnYXV0b3JpZGFkJyB8ICdyZXNwb25zYWJsZScsIFxuICBpbmRleDogbnVtYmVyLCBcbiAgZGF0YTogVmFsaWRhY2lvbkRpYXJpYSwgXG4gIHVzZXI6IFVzZXJcbikge1xuICBpZiAoIXBlcm1pdElkIHx8ICFhbmV4b05hbWUgfHwgIXZhbGlkYXRpb25UeXBlIHx8IGluZGV4IDwgMCB8fCAhZGF0YSB8fCAhdXNlcikge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1BhcsOhbWV0cm9zIGludsOhbGlkb3MuJyB9O1xuICB9XG5cbiAgaWYgKCFpc0FkbWluUmVhZHkoKSkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NyZWRlbmNpYWxlcyBkZSBhZG1pbmlzdHJhZG9yIGRlIEZpcmViYXNlIG5vIGNvbmZpZ3VyYWRhcyBlbiBlbCBzZXJ2aWRvci4nIH07XG4gIH1cblxuICBjb25zdCBkb2NSZWYgPSBhZG1pbkRiLmNvbGxlY3Rpb24oJ3Blcm1pdHMnKS5kb2MocGVybWl0SWQpO1xuICB0cnkge1xuICAgIGNvbnN0IHBlcm1pdFNuYXAgPSBhd2FpdCBkb2NSZWYuZ2V0KCk7XG4gICAgaWYgKCFwZXJtaXRTbmFwLmV4aXN0cykge1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRWwgcGVybWlzbyBubyBleGlzdGUuJyB9O1xuICAgIH1cbiAgICBjb25zdCBwZXJtaXREYXRhID0gcGVybWl0U25hcC5kYXRhKCkgYXMgUGVybWl0O1xuXG4gICAgLy8g4pyFIFZlcmlmaWNhciBxdWUgZWwgcGVybWlzbyBlc3TDqSBlbiBlamVjdWNpw7NuIHBhcmEgdmFsaWRhY2lvbmVzIGRpYXJpYXNcbiAgICBpZiAoIVsnZW5fZWplY3VjaW9uJywgJ3N1c3BlbmRpZG8nXS5pbmNsdWRlcyhwZXJtaXREYXRhLnN0YXR1cykpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnU29sbyBzZSBwdWVkZW4gYWdyZWdhciB2YWxpZGFjaW9uZXMgZGlhcmlhcyBlbiBwZXJtaXNvcyBFTiBFSkVDVUNJw5NOIG8gU1VTUEVORElET1MuJyB9O1xuICAgIH1cblxuICAgIGNvbnN0IGFuZXhvRGF0YSA9IChwZXJtaXREYXRhIGFzIGFueSlbYW5leG9OYW1lXTtcbiAgICBpZiAoIWFuZXhvRGF0YSkge1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBgRWwgYW5leG8gJHthbmV4b05hbWV9IG5vIGV4aXN0ZSBlbiBlbCBwZXJtaXNvLmAgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgYW5leG9VcGRhdGU6IGFueSA9IHsgLi4uYW5leG9EYXRhIH07XG4gICAgaWYgKCFhbmV4b1VwZGF0ZS52YWxpZGFjaW9uKSB7XG4gICAgICAgIGFuZXhvVXBkYXRlLnZhbGlkYWNpb24gPSB7IGF1dG9yaWRhZDogW10sIHJlc3BvbnNhYmxlOiBbXSB9O1xuICAgIH1cblxuICAgIGNvbnN0IHZhbGlkYXRpb25BcnJheSA9IChhbmV4b1VwZGF0ZS52YWxpZGFjaW9uW3ZhbGlkYXRpb25UeXBlXSBhcyBWYWxpZGFjaW9uRGlhcmlhW10pIHx8IFtdO1xuICAgIFxuICAgIHdoaWxlICh2YWxpZGF0aW9uQXJyYXkubGVuZ3RoIDw9IGluZGV4KSB7XG4gICAgICAgIHZhbGlkYXRpb25BcnJheS5wdXNoKHsgZGlhOiB2YWxpZGF0aW9uQXJyYXkubGVuZ3RoICsgMSwgbm9tYnJlOiAnJywgZmVjaGE6ICcnLCBmaXJtYTogJycgfSk7XG4gICAgfVxuXG4gICAgdmFsaWRhdGlvbkFycmF5W2luZGV4XSA9IGRhdGE7XG4gICAgXG4gICAgY29uc3QgdXBkYXRlUGF0aCA9IGAke2FuZXhvTmFtZX0udmFsaWRhY2lvbi4ke3ZhbGlkYXRpb25UeXBlfWA7XG4gICAgXG4gICAgYXdhaXQgZG9jUmVmLnVwZGF0ZSh7XG4gICAgICBbdXBkYXRlUGF0aF06IHZhbGlkYXRpb25BcnJheSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGZ1bGxQZXJtaXREYXRhID0geyBpZDogZG9jUmVmLmlkLCAuLi5wZXJtaXREYXRhIH0gYXMgUGVybWl0O1xuICAgIGNvbnN0IGFuZXhvRGlzcGxheU5hbWUgPSBhbmV4b05hbWUucmVwbGFjZSgnYW5leG8nLCAnQW5leG8gJyk7XG4gICAgY29uc3QgdmFsaWRhdGlvblJvbGVOYW1lID0gdmFsaWRhdGlvblR5cGUgPT09ICdhdXRvcmlkYWQnID8gJ0F1dG9yaWRhZCBkZWwgw4FyZWEnIDogJ1Jlc3BvbnNhYmxlIGRlbCBUcmFiYWpvJztcbiAgICBjb25zdCBkYXkgPSBpbmRleCArIDE7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gYCR7dXNlci5kaXNwbGF5TmFtZSB8fCAnVW4gdXN1YXJpbyd9IGhhIHJlYWxpemFkbyBsYSB2YWxpZGFjacOzbiBkaWFyaWEgKCR7dmFsaWRhdGlvblJvbGVOYW1lfSkgcGFyYSBlbCBEw41BICR7ZGF5fSBkZWwgJHthbmV4b0Rpc3BsYXlOYW1lfSBlbiBlbCBwZXJtaXNvICMke2Z1bGxQZXJtaXREYXRhLm51bWJlcn0uYDtcbiAgICBjb25zdCBpbnZvbHZlZFVzZXJzID0gYXdhaXQgZ2V0SW52b2x2ZWRVc2VycyhmdWxsUGVybWl0RGF0YSk7XG4gICAgZm9yIChjb25zdCB1aWQgb2YgaW52b2x2ZWRVc2Vycykge1xuICAgICAgaWYgKHVpZCAhPT0gdXNlci51aWQpIHtcbiAgICAgICAgYXdhaXQgY3JlYXRlTm90aWZpY2F0aW9uKHVpZCwgZnVsbFBlcm1pdERhdGEsIG1lc3NhZ2UsICdzdGF0dXNfY2hhbmdlJywgeyB1aWQ6IHVzZXIudWlkLCBkaXNwbGF5TmFtZTogdXNlci5kaXNwbGF5TmFtZSB8fCBudWxsIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTCB8fCAnaHR0cHM6Ly9zZ3B0LW1vdmlsLndlYi5hcHAnO1xuICAgIGNvbnN0IHBlcm1pdFVybCA9IGAke2Jhc2VVcmx9L3Blcm1pdHMvJHtwZXJtaXRJZH1gO1xuICAgIGNvbnN0IHdoYXRzYXBwTWVzc2FnZSA9IGAqVmFsaWRhY2nDs24gRGlhcmlhIC0gU0dUQyog4pyN77iPXG5TZSBoYSByZWdpc3RyYWRvIHVuYSBudWV2YSBmaXJtYSBkZSB2YWxpZGFjacOzbiBkaWFyaWEuXG5cbvCfk4QgKlBlcm1pc286KiAke2Z1bGxQZXJtaXREYXRhLm51bWJlciB8fCAnTi9BJ31cbvCfl5PvuI8gKkTDrWE6KiAke2RheX1cbvCfkaQgKkZpcm1hbnRlOiogJHt1c2VyLmRpc3BsYXlOYW1lIHx8ICdOL0EnfVxu4pyFICpSb2w6KiAke3ZhbGlkYXRpb25Sb2xlTmFtZX1cbvCfk4sgKkFuZXhvOiogJHthbmV4b0Rpc3BsYXlOYW1lfVxuXG5QdWVkZSB2ZXIgbG9zIGRldGFsbGVzIGFxdcOtOlxuJHtwZXJtaXRVcmx9YDtcbiAgICBcbiAgICBhd2FpdCBzZW5kV2hhdHNBcHBOb3RpZmljYXRpb24od2hhdHNhcHBNZXNzYWdlKTtcblxuICAgIHJldmFsaWRhdGVQYXRoKGAvcGVybWl0cy8ke3Blcm1pdElkfWApO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBhbCBndWFyZGFyIGxhIHZhbGlkYWNpw7NuIGRpYXJpYTpcIiwgZXJyb3IpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vIHNlIHB1ZG8gZ3VhcmRhciBsYSBmaXJtYSBkZSB2YWxpZGFjacOzbi4nIH07XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZFdvcmtlclNpZ25hdHVyZShwZXJtaXRJZDogc3RyaW5nLCB3b3JrZXJJbmRleDogbnVtYmVyLCBzaWduYXR1cmVUeXBlOiAnZmlybWFBcGVydHVyYScgfCAnZmlybWFDaWVycmUnLCBzaWduYXR1cmVEYXRhVXJsOiBzdHJpbmcpIHtcbiAgICBpZiAoIXBlcm1pdElkIHx8IHdvcmtlckluZGV4IDwgMCB8fCAhc2lnbmF0dXJlVHlwZSB8fCAhc2lnbmF0dXJlRGF0YVVybCkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWx0YW4gcGFyw6FtZXRyb3MuJyB9O1xuICAgIH1cbiAgICBpZiAoIWlzQWRtaW5SZWFkeSgpKSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDcmVkZW5jaWFsZXMgZGUgYWRtaW5pc3RyYWRvciBkZSBGaXJlYmFzZSBubyBjb25maWd1cmFkYXMgZW4gZWwgc2Vydmlkb3IuJyB9O1xuICAgIH1cblxuICAgIGNvbnN0IGRvY1JlZiA9IGFkbWluRGIuY29sbGVjdGlvbigncGVybWl0cycpLmRvYyhwZXJtaXRJZCk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGVybWl0U25hcCA9IGF3YWl0IGRvY1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCFwZXJtaXRTbmFwLmV4aXN0cykge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRWwgcGVybWlzbyBubyBleGlzdGUuJyB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGVybWl0RGF0YSA9IHBlcm1pdFNuYXAuZGF0YSgpIGFzIFBlcm1pdDtcbiAgICAgICAgXG4gICAgICAgIC8vIOKchSBDT1JSRUNDScOTTjogVmFsaWRhY2nDs24gZGUgZXN0YWRvIGNvcnJlZ2lkYSBwYXJhIGZpcm1hIGRlIGFwZXJ0dXJhXG4gICAgICAgIGlmIChzaWduYXR1cmVUeXBlID09PSAnZmlybWFBcGVydHVyYScgJiYgIVsncGVuZGllbnRlX3JldmlzaW9uJywgJ2Fwcm9iYWRvJywgJ2VuX2VqZWN1Y2lvbiddLmluY2x1ZGVzKHBlcm1pdERhdGEuc3RhdHVzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnU29sbyBzZSBwdWVkZSBmaXJtYXIgYXBlcnR1cmEgY3VhbmRvIGVsIHBlcm1pc28gZXN0w6EgcGVuZGllbnRlLCBhcHJvYmFkbyBvIGVuIGVqZWN1Y2nDs24uJyB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzaWduYXR1cmVUeXBlID09PSAnZmlybWFDaWVycmUnICYmICFbJ2VuX2VqZWN1Y2lvbicsICdzdXNwZW5kaWRvJ10uaW5jbHVkZXMocGVybWl0RGF0YS5zdGF0dXMpKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdTb2xvIHNlIHB1ZWRlIGZpcm1hciBjaWVycmUgZW4gcGVybWlzb3MgRU4gRUpFQ1VDScOTTiBvIFNVU1BFTkRJRE9TLicgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3Qgd29ya2VycyA9IHBlcm1pdERhdGEud29ya2VycyA/IFsuLi5wZXJtaXREYXRhLndvcmtlcnNdIDogW107XG5cbiAgICAgICAgaWYgKHdvcmtlckluZGV4ID49IHdvcmtlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICfDjW5kaWNlIGRlIHRyYWJhamFkb3IgaW52w6FsaWRvLicgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZUZpZWxkID0gc2lnbmF0dXJlVHlwZSA9PT0gJ2Zpcm1hQXBlcnR1cmEnID8gJ2Zpcm1hQXBlcnR1cmEnIDogJ2Zpcm1hQ2llcnJlJztcbiAgICAgICAgY29uc3QgZGF0ZUZpZWxkID0gc2lnbmF0dXJlVHlwZSA9PT0gJ2Zpcm1hQXBlcnR1cmEnID8gJ2ZlY2hhRmlybWFBcGVydHVyYScgOiAnZmVjaGFGaXJtYUNpZXJyZSc7XG5cbiAgICAgICAgd29ya2Vyc1t3b3JrZXJJbmRleF0gPSB7XG4gICAgICAgICAgICAuLi53b3JrZXJzW3dvcmtlckluZGV4XSxcbiAgICAgICAgICAgIFtzaWduYXR1cmVGaWVsZF06IHNpZ25hdHVyZURhdGFVcmwsXG4gICAgICAgICAgICBbZGF0ZUZpZWxkXTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCBcbiAgICAgICAgfTtcblxuICAgICAgICBhd2FpdCBkb2NSZWYudXBkYXRlKHsgd29ya2Vyczogd29ya2VycyB9KTtcblxuICAgICAgICByZXZhbGlkYXRlUGF0aChgL3Blcm1pdHMvJHtwZXJtaXRJZH1gKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFsIGd1YXJkYXIgbGEgZmlybWEgZGVsIHRyYWJhamFkb3I6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm8gc2UgcHVkbyBndWFyZGFyIGxhIGZpcm1hLicgfTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6InlTQTRNc0IifQ==
}}),

};

//# sourceMappingURL=src_app_%28app%29_permits_data%3A2f5de7_d71a3d3e._.js.map