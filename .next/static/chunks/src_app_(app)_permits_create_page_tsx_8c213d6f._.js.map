{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/permits/create/page.tsx"],"sourcesContent":["\n'use client';\nimport * as React from 'react';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useUser } from '@/hooks/use-user';\nimport { useToast } from '@/hooks/use-toast';\nimport { createPermit, savePermitDraft } from '../actions';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport {\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  FileText,\n  Users,\n  Shield,\n  Upload,\n  Camera,\n  Wand2,\n  Loader2,\n  X,\n  UserPlus,\n  Signature,\n  FileUp,\n  Edit,\n  Plus,\n  Trash2,\n  Clock,\n  Check,\n  ArrowRight,\n  ArrowLeft,\n  Copy,\n  Save,\n} from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n  DialogFooter,\n} from '@/components/ui/dialog';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport type { Permit, ExternalWorker, Tool, AnexoAltura, AnexoConfinado, AnexoIzaje, MedicionAtmosferica, AnexoEnergias, AnexoATS, PermitGeneralInfo, ValidacionDiaria, AutorizacionPersona, PruebaGasesPeriodica, AnexoCaliente, AnexoExcavaciones, JustificacionATS, EppEmergencias } from '@/types';\nimport { SignaturePad } from '@/components/ui/signature-pad';\nimport Image from 'next/image';\nimport { PermitFormProvider, usePermitForm } from './form-context';\nimport { GeneralInfoStep } from './components/GeneralInfoStep';\nimport { AtsStep } from './components/AtsStep';\nimport { AnexoAlturaStep } from './components/AnexoAlturaStep';\nimport { AnexoConfinadoStep } from './components/AnexoConfinadoStep';\nimport { AnexoEnergiaStep } from './components/AnexoEnergiaStep';\nimport { AnexoIzajeStep } from './components/AnexoIzajeStep';\nimport { AnexoExcavacionesStep } from './components/AnexoExcavacionesStep';\nimport { VerificacionPeligrosStep } from './components/VerificacionPeligrosStep';\nimport { EppEmergenciasStep, eppItems } from './components/EppEmergenciasStep';\nimport { WorkersStep } from './components/WorkersStep';\nimport { ReviewStep } from './components/ReviewStep';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { doc, getDoc } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\n\n\nconst workerRoles = [\n  \"Trabajador autorizado\",\n  \"Ayudante de seguridad\",\n  \"Coordinador de TA\",\n  \"Supervisor de EC\",\n  \"Soldador\",\n  \"Operador de equipo para elevación de personas\",\n  \"Vigía\",\n  \"Otro\"\n];\n\nfunction CreatePermitWizard() {\n  const { user } = useUser();\n  const { toast } = useToast();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n\n  const { state: formData, dispatch } = usePermitForm();\n  \n  const [draftId, setDraftId] = useState<string | undefined>(undefined);\n  const [isLoadingForm, setIsLoadingForm] = useState(true);\n\n  const [step, setStep] = useState(1);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSavingDraft, setIsSavingDraft] = useState(false);\n  const [showSuccessDialog, setShowSuccessDialog] = useState(false);\n  const [newPermitInfo, setNewPermitInfo] = useState({ id: '', number: '' });\n\n  // Worker Dialog State\n  const [isWorkerDialogOpen, setIsWorkerDialogOpen] = useState(false);\n  const [currentWorker, setCurrentWorker] = useState<Partial<ExternalWorker> | null>(null);\n  const [editingWorkerIndex, setEditingWorkerIndex] = useState<number | null>(null);\n  \n  // Signature Pad State\n  const [isSignaturePadOpen, setIsSignaturePadOpen] = useState(false);\n  const [signatureTarget, setSignatureTarget] = useState<string | null>(null);\n  const [signatureContext, setSignatureContext] = useState<any>(null);\n  \n  // Scroll to top on step change\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [step]);\n\n\n  useEffect(() => {\n    const editId = searchParams.get('edit');\n    if (editId) {\n      setIsLoadingForm(true);\n      const fetchDraft = async () => {\n        try {\n          const docRef = doc(db, 'permits', editId);\n          const docSnap = await getDoc(docRef);\n          if (docSnap.exists() && docSnap.data().status === 'borrador') {\n            const draftData = docSnap.data() as Permit;\n            // Populate form state from draft\n            dispatch({ type: 'UPDATE_GENERAL_INFO', payload: draftData.generalInfo || {} });\n            dispatch({ type: 'SET_WORKERS', payload: draftData.workers || [] });\n            // Populate other steps...\n            // e.g., dispatch({ type: 'UPDATE_ATS', payload: draftData.anexoATS || {} });\n            setDraftId(editId);\n          } else {\n            toast({ variant: \"destructive\", title: \"Borrador no encontrado\" });\n            router.push('/permits/create');\n          }\n        } catch (error) {\n          toast({ variant: \"destructive\", title: \"Error al cargar borrador\" });\n        } finally {\n          setIsLoadingForm(false);\n        }\n      };\n      fetchDraft();\n    } else {\n      setIsLoadingForm(false);\n    }\n  }, [searchParams, dispatch, router, toast]);\n\n  useEffect(() => {\n    if (user && !formData.generalInfo.nombreSolicitante) {\n      dispatch({ type: 'UPDATE_GENERAL_INFO', payload: { nombreSolicitante: user.displayName || '' } });\n    }\n  }, [user, formData.generalInfo.nombreSolicitante, dispatch]);\n\n  const openNewWorkerDialog = () => {\n    setEditingWorkerIndex(null);\n    setCurrentWorker({\n      nombre: '',\n      cedula: '',\n      rol: '',\n      eps: '',\n      arl: '',\n      pensiones: '',\n      tsaTec: 'na',\n      entrenamiento: 'otro',\n      firmaApertura: '',\n      firmaCierre: ''\n    });\n    setIsWorkerDialogOpen(true);\n  };\n  \n  const openEditWorkerDialog = (worker: ExternalWorker, index: number) => {\n    setEditingWorkerIndex(index);\n    setCurrentWorker(worker);\n    setIsWorkerDialogOpen(true);\n  };\n\n  const handleSaveWorker = () => {\n    if (!currentWorker || !currentWorker.nombre || !currentWorker.cedula || !currentWorker.rol) {\n      toast({\n        variant: 'destructive',\n        title: 'Campos Incompletos',\n        description: 'Nombre, cédula y rol son requeridos.',\n      });\n      return;\n    }\n\n    if (editingWorkerIndex !== null) {\n      const updatedWorkers = [...(formData.workers || [])];\n      updatedWorkers[editingWorkerIndex] = currentWorker as ExternalWorker;\n      dispatch({ type: 'SET_WORKERS', payload: updatedWorkers });\n      toast({ title: 'Trabajador Actualizado' });\n    } else {\n      dispatch({ type: 'ADD_WORKER', payload: currentWorker as ExternalWorker });\n      toast({ title: 'Trabajador Agregado' });\n    }\n\n    setIsWorkerDialogOpen(false);\n    setCurrentWorker(null);\n    setEditingWorkerIndex(null);\n  };\n  \n  const removeWorker = (index: number) => {\n    const updatedWorkers = (formData.workers || []).filter((_, i) => i !== index);\n    dispatch({ type: 'SET_WORKERS', payload: updatedWorkers });\n  };\n  \n  const handleWorkerInputChange = (field: keyof ExternalWorker, value: string | boolean) => {\n    setCurrentWorker(prev => prev ? { ...prev, [field]: value } : null);\n  };\n\n  const openSignaturePad = (target: string, context?: any) => {\n    setSignatureTarget(target);\n    setSignatureContext(context);\n    setIsSignaturePadOpen(true);\n  };\n\n  const handleSaveSignature = (signatureDataUrl: string) => {\n    if (!signatureTarget) return;\n\n    if (signatureTarget === 'worker.firmaApertura' || signatureTarget === 'worker.firmaCierre') {\n       setCurrentWorker(prev => prev ? { ...prev, [signatureTarget.split('.')[1]]: signatureDataUrl } : null);\n    } else {\n       dispatch({ type: 'UPDATE_SIGNATURE', payload: { target: signatureTarget, signature: signatureDataUrl, context: signatureContext }});\n    }\n\n    setIsSignaturePadOpen(false);\n    setSignatureTarget(null);\n    setSignatureContext(null);\n  };\n  \n  const handleSaveDraft = async () => {\n    if (!user) {\n      toast({ variant: 'destructive', title: 'Error de Autenticación' });\n      return;\n    }\n\n    setIsSavingDraft(true);\n    try {\n      const result = await savePermitDraft({\n          userId: user.uid, \n          userDisplayName: user.displayName || null, \n          userEmail: user.email || null,\n          userPhotoURL: user.photoURL || null,\n          draftId: draftId,\n          ...formData\n      });\n\n      if (result.success && result.permitId) {\n        if (!draftId) {\n          setDraftId(result.permitId);\n        }\n        toast({ title: \"Borrador Guardado\", description: \"Tu progreso ha sido guardado.\" });\n      } else {\n        throw new Error(result.error || 'No se pudo guardar el borrador.');\n      }\n    } catch (error: any) {\n      toast({ variant: 'destructive', title: 'Error al Guardar', description: error.message });\n    } finally {\n      setIsSavingDraft(false);\n    }\n  };\n\n  const colors = {\n    primary: 'hsl(var(--primary))',\n    dark: 'hsl(var(--primary))', \n    success: 'hsl(var(--accent))',\n  };\n  \n  const baseSteps = [\n    { label: \"Info General\", condition: true },\n    { label: \"ATS\", condition: true },\n    { label: \"Anexo Altura\", condition: formData.selectedWorkTypes.alturas},\n    { label: \"Anexo Confinado\", condition: formData.selectedWorkTypes.confinado},\n    { label: \"Anexo Energías\", condition: formData.selectedWorkTypes.energia},\n    { label: \"Anexo Izaje\", condition: formData.selectedWorkTypes.izaje},\n    { label: \"Anexo Excavaciones\", condition: formData.selectedWorkTypes.excavacion},\n    { label: \"Verificación Peligros\", condition: true },\n    { label: \"EPP y Emergencias\", condition: true },\n    { label: \"Trabajadores\", condition: true },\n    { label: \"Revisión\", condition: true }\n  ];\n\n  const steps = baseSteps.filter(s => s.condition);\n  const currentStepInfo = steps[step - 1];\n\n  const canProceed = () => {\n    const currentLabel = steps[step - 1]?.label;\n\n    if (currentLabel === 'Info General') {\n        const { areaEspecifica, planta, nombreSolicitante, validFrom, validUntil, workDescription, numTrabajadores, responsable } = formData.generalInfo;\n        const missingFields = [];\n        if (!areaEspecifica) missingFields.push(\"Área específica\");\n        if (!planta) missingFields.push(\"Planta\");\n        if (!nombreSolicitante) missingFields.push(\"Nombre solicitante\");\n        if (!validFrom) missingFields.push(\"Fecha de inicio\");\n        if (!validUntil) missingFields.push(\"Fecha de fin\");\n        if (!workDescription) missingFields.push(\"Descripción de la Tarea\");\n        if (!numTrabajadores) missingFields.push(\"No. Trabajadores\");\n        if (!responsable?.nombre) missingFields.push(\"Nombre del Responsable\");\n        if (!responsable?.cargo) missingFields.push(\"Cargo del Responsable\");\n        if (!responsable?.compania) missingFields.push(\"Compañía del Responsable\");\n\n        if (!Object.values(formData.selectedWorkTypes).some(v => v)) {\n            missingFields.push(\"Tipo de Trabajo (al menos uno)\");\n        }\n\n        if (missingFields.length > 0) {\n            toast({\n                variant: \"destructive\",\n                title: \"Campos Incompletos en Información General\",\n                description: `Por favor, complete los siguientes campos obligatorios: ${missingFields.join(', ')}.`,\n                duration: 6000,\n            });\n            return false;\n        }\n    }\n\n    if (currentLabel === 'ATS') {\n        const { peligros, justificacion } = formData.anexoATS;\n        if (!peligros || !Object.values(peligros).some(value => value === 'si')) {\n            toast({\n                variant: \"destructive\",\n                title: \"Validación Requerida en ATS\",\n                description: \"Debe seleccionar 'SI' en al menos un peligro para continuar.\",\n            });\n            return false;\n        }\n        if (!justificacion || !Object.values(justificacion).some(value => value === true)) {\n            toast({\n                variant: \"destructive\",\n                title: \"Validación Requerida en ATS\",\n                description: \"Debe seleccionar al menos una 'Justificación para el uso del ATS' para continuar.\",\n            });\n            return false;\n        }\n    }\n\n    if (currentLabel === 'EPP y Emergencias') {\n        const eppData = formData.eppEmergencias?.epp || {};\n        const missingSpecFields = eppItems\n            .filter(item => item.manual && eppData[item.id] === 'si')\n            .filter(item => {\n                const specFieldKey = `${item.id}_manual`;\n                const specValue = eppData[specFieldKey] as string | undefined;\n                return !specValue || specValue.trim() === '';\n            })\n            .map(item => `'${item.label}'`);\n\n        if (missingSpecFields.length > 0) {\n            toast({\n                variant: \"destructive\",\n                title: \"Especificación de EPP Requerida\",\n                description: `Por favor, complete la especificación para los siguientes EPP: ${missingSpecFields.join(', ')}.`,\n                duration: 6000,\n            });\n            return false;\n        }\n    }\n    \n    if (currentLabel === 'Anexo Altura') {\n      const anexo = formData.anexoAltura;\n      if (anexo?.tipoEstructura?.otros && !anexo.tipoEstructura.otrosCual?.trim()) {\n        toast({ variant: \"destructive\", title: \"Campo Requerido\", description: \"Debe especificar el otro tipo de estructura en el Anexo de Alturas.\" });\n        return false;\n      }\n    }\n\n    if (currentLabel === 'Anexo Confinado') {\n      const anexo = formData.anexoConfinado;\n      if (anexo?.identificacionPeligros?.procedimientoComunicacion === 'si' && !anexo.procedimientoComunicacionCual?.trim()) {\n        toast({ variant: \"destructive\", title: \"Campo Requerido\", description: \"Debe especificar cuál es el procedimiento de comunicación en el Anexo de Espacios Confinados.\" });\n        return false;\n      }\n    }\n    \n    if (currentLabel === 'Anexo Energías') {\n        const anexo = formData.anexoEnergias;\n        if (anexo?.trabajosEnCaliente?.otro === 'si' && !(anexo.trabajosEnCaliente?.otroCual as string)?.trim()) {\n          toast({ variant: \"destructive\", title: \"Campo Requerido\", description: \"Debe especificar el 'otro' aspecto en Trabajos en Caliente.\" });\n          return false;\n        }\n        if (anexo?.energiasPeligrosas?.otra && !(anexo.energiasPeligrosas?.otraCual as string)?.trim()) {\n          toast({ variant: \"destructive\", title: \"Campo Requerido\", description: \"Debe especificar el 'otro' tipo de energía peligrosa.\" });\n          return false;\n        }\n    }\n\n    return true;\n  };\n\n  const handleSavePermit = async () => {\n    if (!user) {\n      toast({ variant: 'destructive', title: 'Error de Autenticación' });\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      const result = await createPermit({\n          userId: user.uid, \n          userDisplayName: user.displayName || null, \n          userEmail: user.email || null,\n          userPhotoURL: user.photoURL || null,\n          ...formData\n        });\n      \n      if (result.success && result.permitId) {\n        setNewPermitInfo({\n            id: result.permitId,\n            number: result.permitNumber || '',\n        });\n        setShowSuccessDialog(true);\n      } else {\n        throw new Error(result.error || 'Hubo un error creando el permiso.');\n      }\n      \n    } catch (error: any) {\n      toast({\n        variant: 'destructive',\n        title: 'Falló el Envío',\n        description: error.message,\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n  \n  const handleUpdateATS = useCallback((updates: Partial<AnexoATS>) => {\n    dispatch({ type: 'UPDATE_ATS', payload: updates });\n  }, [dispatch]);\n\n  const handleUpdateEppEmergencias = useCallback((updates: Partial<EppEmergencias>) => {\n    dispatch({ type: 'UPDATE_EPP_EMERGENCIAS', payload: updates });\n  }, [dispatch]);\n\n  const renderStepContent = () => {\n    if (isLoadingForm) {\n      return (\n        <div className=\"flex justify-center items-center h-64\">\n          <Loader2 className=\"h-8 w-8 animate-spin\" />\n        </div>\n      );\n    }\n\n    const currentStepLabel = steps[step - 1]?.label;\n    switch (currentStepLabel) {\n      case \"Info General\":\n        return <GeneralInfoStep />;\n      case \"ATS\":\n        return <AtsStep anexoATS={formData.anexoATS as AnexoATS} onUpdateATS={handleUpdateATS} />;\n      case \"Anexo Altura\":\n        return <AnexoAlturaStep />;\n      case \"Anexo Confinado\":\n        return <AnexoConfinadoStep />;\n      case \"Anexo Energías\":\n        return <AnexoEnergiaStep />;\n      case \"Anexo Izaje\":\n        return <AnexoIzajeStep />;\n      case \"Anexo Excavaciones\":\n        return <AnexoExcavacionesStep />;\n      case \"Verificación Peligros\":\n        return <VerificacionPeligrosStep />;\n      case \"EPP y Emergencias\":\n        return <EppEmergenciasStep eppEmergencias={formData.eppEmergencias as EppEmergencias} onUpdate={handleUpdateEppEmergencias} />;\n      case \"Trabajadores\":\n        return <WorkersStep \n                  workers={formData.workers || []}\n                  onAddWorker={openNewWorkerDialog}\n                  onEditWorker={openEditWorkerDialog}\n                  onRemoveWorker={removeWorker}\n               />;\n      case \"Revisión\":\n        return <ReviewStep />;\n      default:\n        return (\n          <div className=\"text-center p-8\">\n            <h3 className=\"text-xl font-bold\">Paso en Construcción</h3>\n            <p className=\"text-muted-foreground\">{currentStepLabel}</p>\n          </div>\n        );\n    }\n  };\n\n  return (\n    <>\n    <div className=\"flex flex-1 flex-col bg-gray-50 min-h-screen\">\n      <header className=\"text-white shadow-lg sticky top-0 z-20\" style={{ background: `linear-gradient(135deg, ${colors.primary} 0%, ${colors.dark} 100%)` }}>\n        <div className=\"max-w-7xl mx-auto px-4 py-3 md:py-4\">\n          <div className=\"flex justify-between items-center\">\n            <div>\n              <div className=\"flex items-center gap-3\">\n                <Image \n                    src=\"https://i.postimg.cc/jShP2K6k/Whats-App-Image-2025-10-20-at-10-43-48-AM.jpg\"\n                    alt=\"Crear Permiso Icon\"\n                    width={48}\n                    height={48}\n                    className=\"rounded-full\"\n                />\n                <div className=\"hidden md:block border-l border-white border-opacity-30 pl-3\">\n                  <h1 className=\"text-xl font-bold\">Nuevo Permiso de Trabajo</h1>\n                  <p className=\"text-sm text-white text-opacity-80\">\n                    Paso {step} de {steps.length}: {currentStepInfo.label}\n                  </p>\n                </div>\n              </div>\n            </div>\n            <Button\n              onClick={() => {\n                if (confirm('¿Está seguro de cancelar? Los cambios no guardados se perderán.')) {\n                  router.push('/dashboard');\n                }\n              }}\n              variant=\"ghost\"\n              className=\"bg-white bg-opacity-20 hover:bg-opacity-30\"\n            >\n              <X size={18} className=\"mr-2\" />\n              <span className=\"hidden sm:inline\">Cancelar</span>\n            </Button>\n          </div>\n        </div>\n      </header>\n      \n      <div className=\"bg-white border-b shadow-sm sticky top-[68px] md:top-[80px] z-10\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4 md:py-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            {steps.map((s_info, s_idx) => {\n              const s = s_idx + 1;\n              return(\n              <div key={s} className=\"flex items-center flex-1\">\n                <div className={`relative flex items-center justify-center w-8 h-8 md:w-10 md:h-10 rounded-full font-bold text-sm transition-all ${\n                  s === step ? 'ring-4 scale-110 shadow-lg text-white' :\n                  s < step ? 'text-white' :\n                  'bg-gray-200 text-gray-600'\n                }`}\n                style={s <= step ? { backgroundColor: s === step ? colors.primary : colors.success } : {}}>\n                  {s < step ? <CheckCircle size={20}/> : s_idx + 1}\n                </div>\n                {s < steps.length && (\n                  <div className=\"flex-1 h-1 mx-1 md:mx-2 rounded\" style={{ \n                    backgroundColor: s < step ? colors.success : '#E5E7EB' \n                  }} />\n                )}\n              </div>\n            )})}\n          </div>\n          <div className=\"grid\" style={{gridTemplateColumns: `repeat(${steps.length}, minmax(0, 1fr))`}}>\n            {steps.map((s_info, s_idx) => (\n              <span key={s_idx} className=\"text-[10px] md:text-xs text-center font-medium\" style={{ color: step === s_idx + 1 ? colors.primary : '#6B7280' }}>{s_info.label}</span>\n            ))}\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"max-w-5xl mx-auto p-4 pb-24 md:pb-24 w-full\">\n        <div key={step} className=\"bg-white rounded-xl shadow-xl p-6 md:p-8\">\n          {renderStepContent()}\n        </div>\n\n        {/* Navigation Buttons */}\n        <div className=\"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-sm border-t shadow-lg z-20\">\n          <div className=\"max-w-5xl mx-auto px-4 py-3 flex gap-2 sm:gap-4\">\n            <Button\n              onClick={() => setStep(step - 1)}\n              disabled={isSubmitting || step === 1}\n              variant=\"outline\"\n              className=\"px-4 py-3 h-auto md:px-6\"\n            >\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Anterior\n            </Button>\n            \n            <Button\n                onClick={handleSaveDraft}\n                variant=\"secondary\"\n                disabled={isSavingDraft || isSubmitting}\n                className=\"px-4 py-3 h-auto md:px-6\"\n            >\n                {isSavingDraft ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\"/> : <Save className=\"mr-2 h-4 w-4\"/>}\n                Borrador\n            </Button>\n\n            {step < steps.length ? (\n              <Button\n                onClick={() => {\n                  if (canProceed()) {\n                    setStep(step + 1);\n                  }\n                }}\n                disabled={isSubmitting}\n                className=\"flex-1 py-3 h-auto\"\n              >\n                Siguiente\n                <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Button>\n            ) : (\n                <AlertDialog>\n                    <AlertDialogTrigger asChild>\n                         <Button\n                            disabled={isSubmitting}\n                            className=\"flex-1 py-3 h-auto bg-green-600 hover:bg-green-700 text-lg\"\n                        >\n                            {isSubmitting ? (\n                            <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                            ) : (\n                            <CheckCircle size={22} className=\"mr-2\" />\n                            )}\n                            <span>Enviar</span>\n                        </Button>\n                    </AlertDialogTrigger>\n                    <AlertDialogContent>\n                        <AlertDialogHeader>\n                            <AlertDialogTitle>¿Está seguro de enviar el permiso?</AlertDialogTitle>\n                            <AlertDialogDescription>\n                                Una vez que envíe el permiso para su aprobación, ya no podrá realizar modificaciones. Asegúrese de que toda la información es correcta.\n                            </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                            <AlertDialogCancel>Cancelar</AlertDialogCancel>\n                            <AlertDialogAction onClick={handleSavePermit} disabled={isSubmitting}>\n                                 {isSubmitting ? 'Enviando...' : 'Sí, enviar ahora'}\n                            </AlertDialogAction>\n                        </AlertDialogFooter>\n                    </AlertDialogContent>\n                </AlertDialog>\n            )}\n          </div>\n        </div>\n      </div>\n      \n      <Dialog open={showSuccessDialog} onOpenChange={setShowSuccessDialog}>\n          <DialogContent>\n              <DialogHeader>\n                  <DialogTitle className=\"flex items-center gap-2 text-green-600\">\n                      <CheckCircle />\n                      ¡Permiso Creado Exitosamente!\n                  </DialogTitle>\n                  <DialogDescription>\n                      El permiso N° <strong>{newPermitInfo.number}</strong> ha sido creado y enviado para revisión.\n                  </DialogDescription>\n              </DialogHeader>\n              <DialogFooter className=\"sm:justify-between gap-2\">\n                  <Button variant=\"outline\" onClick={() => router.push('/dashboard')}>\n                      Ir al Dashboard\n                  </Button>\n                   <Button onClick={() => router.push(`/permits/${newPermitInfo.id}`)}>\n                      Ver Detalles del Permiso\n                   </Button>\n              </DialogFooter>\n          </DialogContent>\n      </Dialog>\n      \n        <Dialog open={isWorkerDialogOpen} onOpenChange={setIsWorkerDialogOpen}>\n            <DialogContent className=\"sm:max-w-lg\">\n                <DialogHeader>\n                    <DialogTitle>{editingWorkerIndex !== null ? 'Editar' : 'Agregar'} Trabajador</DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4 max-h-[70vh] overflow-y-auto p-4\">\n                    <div>\n                        <Label htmlFor=\"worker-name\">Nombres y Apellidos</Label>\n                        <Input id=\"worker-name\" value={currentWorker?.nombre || ''} onChange={(e) => handleWorkerInputChange('nombre', e.target.value)} />\n                    </div>\n                    <div>\n                        <Label htmlFor=\"worker-cedula\">Cédula</Label>\n                        <Input id=\"worker-cedula\" value={currentWorker?.cedula || ''} onChange={(e) => handleWorkerInputChange('cedula', e.target.value)} />\n                    </div>\n                    <div>\n                        <Label htmlFor=\"worker-rol\">Cargo/Rol</Label>\n                        <Select value={currentWorker?.rol || ''} onValueChange={(value) => handleWorkerInputChange('rol', value)}>\n                            <SelectTrigger id=\"worker-rol\"><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                                {workerRoles.map(role => <SelectItem key={role} value={role}>{role}</SelectItem>)}\n                            </SelectContent>\n                        </Select>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <Label className=\"font-semibold\">Certificado Aptitud Médica</Label>\n                        <div className=\"flex gap-4\">\n                            <div className=\"flex items-center gap-2\"><Checkbox id=\"cert-tec\" checked={currentWorker?.tsaTec === 'tec'} onCheckedChange={checked => handleWorkerInputChange('tsaTec', checked ? 'tec' : 'na')} /> <Label htmlFor=\"cert-tec\">TEC</Label></div>\n                            <div className=\"flex items-center gap-2\"><Checkbox id=\"cert-tsa\" checked={currentWorker?.tsaTec === 'tsa'} onCheckedChange={checked => handleWorkerInputChange('tsaTec', checked ? 'tsa' : 'na')} /> <Label htmlFor=\"cert-tsa\">TSA</Label></div>\n                        </div>\n                    </div>\n                     <div className=\"space-y-2\">\n                        <Label className=\"font-semibold\">Entrenamiento / Capacitación</Label>\n                        <div className=\"flex gap-4\">\n                             <div className=\"flex items-center gap-2\"><Checkbox id=\"ent-tec\" checked={currentWorker?.entrenamiento === 'tec'} onCheckedChange={checked => handleWorkerInputChange('entrenamiento', checked ? 'tec' : 'otro')} /> <Label htmlFor=\"ent-tec\">TEC</Label></div>\n                            <div className=\"flex items-center gap-2\"><Checkbox id=\"ent-tsa\" checked={currentWorker?.entrenamiento === 'tsa'} onCheckedChange={checked => handleWorkerInputChange('entrenamiento', checked ? 'tsa' : 'otro')} /> <Label htmlFor=\"ent-tsa\">TSA</Label></div>\n                        </div>\n                         <Input placeholder=\"Otro\" value={currentWorker?.entrenamiento === 'otro' ? (currentWorker as any).otroEntrenamiento || '' : ''} onChange={e => handleWorkerInputChange('otroEntrenamiento' as any, e.target.value)} disabled={currentWorker?.entrenamiento !== 'otro'} />\n                    </div>\n                     <div className=\"space-y-2\">\n                        <Label className=\"font-semibold\">Afiliación a Seguridad Social</Label>\n                        <div className=\"flex gap-4\">\n                           <div className=\"flex items-center gap-2\"><Checkbox id=\"afil-eps\" checked={!!currentWorker?.eps} onCheckedChange={checked => handleWorkerInputChange('eps', checked ? 'activo' : '')} /> <Label htmlFor=\"afil-eps\">EPS</Label></div>\n                           <div className=\"flex items-center gap-2\"><Checkbox id=\"afil-arl\" checked={!!currentWorker?.arl} onCheckedChange={checked => handleWorkerInputChange('arl', checked ? 'activo' : '')} /> <Label htmlFor=\"afil-arl\">ARL</Label></div>\n                           <div className=\"flex items-center gap-2\"><Checkbox id=\"afil-pension\" checked={!!currentWorker?.pensiones} onCheckedChange={checked => handleWorkerInputChange('pensiones', checked ? 'activo' : '')} /> <Label htmlFor=\"afil-pension\">Pensiones</Label></div>\n                        </div>\n                    </div>\n                    <div>\n                      <Label>Firma de Apertura</Label>\n                      <Button variant=\"outline\" className=\"w-full mt-2\" onClick={() => openSignaturePad('worker.firmaApertura')}>\n                        <Signature className=\"mr-2\"/> {currentWorker?.firmaApertura ? 'Ver/Cambiar Firma' : 'Registrar Firma'}\n                      </Button>\n                      {currentWorker?.firmaApertura && <Image src={currentWorker.firmaApertura} alt=\"Firma Apertura\" width={150} height={75} className=\"mx-auto mt-2 border rounded-md\"/>}\n                    </div>\n                </div>\n                 <DialogFooter>\n                    <Button variant=\"secondary\" onClick={() => setIsWorkerDialogOpen(false)}>Cancelar</Button>\n                    <Button onClick={handleSaveWorker}>Guardar Trabajador</Button>\n                </DialogFooter>\n            </DialogContent>\n        </Dialog>\n\n       <Dialog open={isSignaturePadOpen} onOpenChange={setIsSignaturePadOpen}>\n        <DialogContent className=\"w-[90vw] max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Registrar Firma</DialogTitle>\n          </DialogHeader>\n          <SignaturePad onSave={handleSaveSignature} />\n        </DialogContent>\n      </Dialog>\n    </div>\n    </>\n  );\n}\n\nexport default function CreatePermitPage() {\n  return (\n    <PermitFormProvider>\n      <CreatePermitWizard />\n    </PermitFormProvider>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}